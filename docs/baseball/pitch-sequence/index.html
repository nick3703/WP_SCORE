<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Max Felter, Matt Toner, and Rachel Gidaro">
<meta name="dcterms.date" content="2025-08-19">
<meta name="description" content="Model Assessment through TPR/FPR, PPV/NPV, and F1 Score">

<title>An Exploration of Pitch Sequencing in Baseball – West Point SCORE Module Preprint Repository</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BNK257S380"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BNK257S380', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">West Point SCORE Module Preprint Repository</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../by-statsds-topic.html" aria-current="page"> 
<span class="menu-text">Modules By Topic</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../_team.html"> 
<span class="menu-text">West Point SCORE Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://modules.scorenetwork.org/"> 
<span class="menu-text">SCORE Module Repository</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://data.scorenetwork.org/"> 
<span class="menu-text">Data Repository</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../baseball/predicting-all-stars/index.html">Baseball</a></li><li class="breadcrumb-item"><a href="../../baseball/pitch-sequence/index.html">An Exploration of Pitch Sequencing in Baseball</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../_team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Team</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../by-statsds-topic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules By Topic</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Baseball</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../baseball/predicting-all-stars/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predicting Allstars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../baseball/pitch-sequence/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">An Exploration of Pitch Sequencing in Baseball</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Basketball</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../basketball/nba-ordinal-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordinal Logistic Regression Basketball Salary Prediction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">BlackJack</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BlackJack/BlackJack_Log_Reg/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BlackJack Logistic Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">External Submissions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../external_submissions/Robotics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FIRST Robotics Competition - Winning Chances</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../external_submissions/Tennis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression with Categorical Variables and ANOVA: Ace Rates in Tennis by Surface</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Lacrosse</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Lacrosse/expected_goals/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expected Goals in Lacrosse</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Obstacle Courses</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../obstacle_courses/West_Point_Indoor_Obstacle_Course/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indoor Obstacle Course Test</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Soccer</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../soccer/soccer_expected_goals/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expected Goals in Soccer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../soccer/Footedness/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Does Footedness Impact Free-Kick Accuracy?</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#displaying-data-in-a-table" id="toc-displaying-data-in-a-table" class="nav-link" data-scroll-target="#displaying-data-in-a-table">Displaying Data in a Table</a></li>
  <li><a href="#creating-new-variables" id="toc-creating-new-variables" class="nav-link" data-scroll-target="#creating-new-variables">Creating New Variables</a></li>
  <li><a href="#transition-matrix" id="toc-transition-matrix" class="nav-link" data-scroll-target="#transition-matrix">Transition Matrix</a></li>
  <li><a href="#expectancy-matrix" id="toc-expectancy-matrix" class="nav-link" data-scroll-target="#expectancy-matrix">Expectancy Matrix</a></li>
  <li><a href="#creating-a-heat-map" id="toc-creating-a-heat-map" class="nav-link" data-scroll-target="#creating-a-heat-map">Creating a Heat Map</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../baseball/predicting-all-stars/index.html">Baseball</a></li><li class="breadcrumb-item"><a href="../../baseball/pitch-sequence/index.html">An Exploration of Pitch Sequencing in Baseball</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">An Exploration of Pitch Sequencing in Baseball</h1>
  <div class="quarto-categories">
    <div class="quarto-category">F1 Score</div>
    <div class="quarto-category">Confusion Matrix</div>
    <div class="quarto-category">Model Assessment</div>
  </div>
  </div>

<div>
  <div class="description">
    Model Assessment through TPR/FPR, PPV/NPV, and F1 Score
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Max Felter, Matt Toner, and Rachel Gidaro </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 19, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Every time a pitcher winds up to throw and a batter steps up to the plate, a multitude of factors are taken into account as they decide what pitch to throw and whether or not to swing. The primary aim of the pitcher is to get the batter out. As the pitcher aims to strike out the batter, they make elemental decisions about what type of pitch to throw and where to throw it. At the time of pitch, the pitcher has obviously made their decision, however, the batter faces a different scenario. Due to the extreme speeds of the pitch, there is little time to react. Many claim that mathematically, it should be nearly impossible for humans to react to and hit an MLB pitch (<a href="https://www.smartnonsense.com/post/baseball" class="uri">https://www.smartnonsense.com/post/baseball</a>). We know, however, that these pitches are hit often and well. Ultimately, the batter is put in a position in which they have to predict the pitch that the pitcher is throwing. This becomes an information game. The batter will have some information from factors such as the windup, but they will also know what pitches have been thrown in the past. All this is to say: both the pitcher and batter are trying to get into the mind of the other, predicting their next move. This would imply that the sequence of pitches that the pitcher employs should play a significant role in their success. If a pitcher threw only one type of pitch or one sequence of pitches, batters would surely catch on and modify their reaction to account for it. Pitch sequencing describes the order of pitches by type, that a pitcher decides to throw during an at-bat. For example, a pitch sequence may be a four seam fastball, a curbevall, then a slider, and finally a two seam fastball.</p>
<p>Pitch sequencing is important since it can increase uncertainty in the batter and help systematically deceive them. For example, a pitcher may utilize a change up after a fastball, as it uses the same arm motion but travels much slower. This slower ball speed can interfere with the batter’s timing and cause an early swing if they were expecting a fast ball. This intuitive proposition that pitch sequencing might play a central role in effective pitching can be validated using the extensive baseball data that exists today. The analysis we will walk you through in this project will help us answer the following research question:</p>
<ul>
<li><p>Does pitch sequencing matter in the MLB?</p></li>
<li><p>If it does, what are the most effective sequences and why might that be?</p></li>
</ul>
<p>After conducting this analysis, you will be equipped to bring data driven decisions to your dugout, arguing for the best next-pitch type decision based on those thrown previously.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By the end of this activity, you will be able to:</p>
<ol type="1">
<li><p>Manipulate data.</p></li>
<li><p>Create a heat map for data visualization.</p></li>
<li><p>Understand the utility of transition and expectancy matrices</p></li>
<li><p>Build and interpret a logistic regression model.</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Activity Length">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Activity Length
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This activity would be suitable for an in class example or homework assignment. This activity could take between 30 to 45 minutes depending on the students familiarity with R.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Methods">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Methods
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To successfully complete this module, students should have prior knowledge of the following statistical concepts:</p>
<ul>
<li>Familiarity with the tidyverse.</li>
</ul>
<p><strong>Technology Requirement:</strong></p>
<ul>
<li>This activity is built for students with a basic understanding of R.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Data Overview">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Overview
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>PITCHf/x is a pitch tracking system installed in all MLB stadiums that effectively measures pitch metrics such as location of the ball as it passes the plate, pitch type, and release speed. PITCHf/x also includes other data relevant to each at-bat such as the batter, the pitcher, the outcome, and the count at the time of pitch. The PITCHf/x entity releases its data online for open use, though it is quite large due to the shear number of pitches in each season. Due to the size, we will produce our analysis using only pitches of the most recent MLB season, 2024. Also due to the size of the dataset we could not include all of the variables. The subset we will use includes:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>game_date</td>
<td>Date of the Game</td>
</tr>
<tr class="even">
<td>game_pk</td>
<td>Pre-pitch number of outs</td>
</tr>
<tr class="odd">
<td>at_bat_number</td>
<td>Plate appearance number of the game</td>
</tr>
<tr class="even">
<td>inning_topbot</td>
<td>Pre-pitch top or bottom of inning</td>
</tr>
<tr class="odd">
<td>inning</td>
<td>Pre-pitch inning number</td>
</tr>
<tr class="even">
<td>batter</td>
<td>MLB Player Id tied to the play event</td>
</tr>
<tr class="odd">
<td>pitch_number</td>
<td>Total pitch number of the plate appearance</td>
</tr>
<tr class="even">
<td>balls</td>
<td>Pre-pitch number of balls in count</td>
</tr>
<tr class="odd">
<td>strikes</td>
<td>Pre-pitch number of strikes in count</td>
</tr>
<tr class="even">
<td>outs_when_up</td>
<td>Pre-pitch number of outs</td>
</tr>
<tr class="odd">
<td>description</td>
<td>Description of the resulting pitch</td>
</tr>
<tr class="even">
<td>pitch_type</td>
<td>The type of pitch derived from Statcast</td>
</tr>
<tr class="odd">
<td>player_name</td>
<td>Player’s name tied to the event of the search.</td>
</tr>
<tr class="even">
<td>pitcher</td>
<td>MLB Player Id tied to the play event</td>
</tr>
<tr class="odd">
<td>events</td>
<td>Event of the resulting Plate Appearance</td>
</tr>
<tr class="even">
<td>plate_x</td>
<td>Horizontal position of the ball when it crosses home plate from the catcher’s perspective</td>
</tr>
<tr class="odd">
<td>plate_z</td>
<td>Vertical position of the ball when it crosses home plate from the catcher’s perspective</td>
</tr>
<tr class="even">
<td>home_team</td>
<td>Abbreviation of home team</td>
</tr>
<tr class="odd">
<td>away_team</td>
<td>Abbreviation of away team</td>
</tr>
</tbody>
</table>
<p>For more information about the variables and the variables that statcast offers, please visit (<a href="https://baseballsavant.mlb.com/csv-docs" class="uri">https://baseballsavant.mlb.com/csv-docs</a>)</p>
</div>
</div>
</div>
</section>
<section id="displaying-data-in-a-table" class="level1">
<h1>Displaying Data in a Table</h1>
<p>The first thing we will do is load in the data and necessary packages. The data can be downloaded <a href="pitch_subset.csv" download="pitch_subset.csv">here</a>. We will include all pitches that occurred in the 2024 MLB season, roughly 700,000 in total:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baseballr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>pitches <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"pitch_subset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to understand what all is contained in the dataset we can run the “dim” function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pitches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 705728     19</code></pre>
</div>
</div>
<p>As we can see, there are <strong>705,728 observations</strong>. In the code below, we used the select function to isolate the variables we wanted to investigate (pitch_type, game_date, player_name, balls, and strikes). We then only want to look at the first 10 observations, so we run head(10). Lastly in order for the output to be formatted nicely, we run gt() and set a table header.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pitches <span class="sc">%&gt;%</span> <span class="fu">select</span>(pitch_type, game_date, player_name, balls, strikes) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"A selected sample of the PITCHf/x data"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Note: This is not all of the important columns, just a view for demonstration purposes."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="khthsoavbk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#khthsoavbk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#khthsoavbk thead, #khthsoavbk tbody, #khthsoavbk tfoot, #khthsoavbk tr, #khthsoavbk td, #khthsoavbk th {
  border-style: none;
}

#khthsoavbk p {
  margin: 0;
  padding: 0;
}

#khthsoavbk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#khthsoavbk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#khthsoavbk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#khthsoavbk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#khthsoavbk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#khthsoavbk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#khthsoavbk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#khthsoavbk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#khthsoavbk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#khthsoavbk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#khthsoavbk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#khthsoavbk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#khthsoavbk .gt_spanner_row {
  border-bottom-style: hidden;
}

#khthsoavbk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#khthsoavbk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#khthsoavbk .gt_from_md > :first-child {
  margin-top: 0;
}

#khthsoavbk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#khthsoavbk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#khthsoavbk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#khthsoavbk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#khthsoavbk .gt_row_group_first td {
  border-top-width: 2px;
}

#khthsoavbk .gt_row_group_first th {
  border-top-width: 2px;
}

#khthsoavbk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#khthsoavbk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#khthsoavbk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#khthsoavbk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#khthsoavbk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#khthsoavbk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#khthsoavbk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#khthsoavbk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#khthsoavbk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#khthsoavbk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#khthsoavbk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#khthsoavbk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#khthsoavbk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#khthsoavbk .gt_left {
  text-align: left;
}

#khthsoavbk .gt_center {
  text-align: center;
}

#khthsoavbk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#khthsoavbk .gt_font_normal {
  font-weight: normal;
}

#khthsoavbk .gt_font_bold {
  font-weight: bold;
}

#khthsoavbk .gt_font_italic {
  font-style: italic;
}

#khthsoavbk .gt_super {
  font-size: 65%;
}

#khthsoavbk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#khthsoavbk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#khthsoavbk .gt_indent_1 {
  text-indent: 5px;
}

#khthsoavbk .gt_indent_2 {
  text-indent: 10px;
}

#khthsoavbk .gt_indent_3 {
  text-indent: 15px;
}

#khthsoavbk .gt_indent_4 {
  text-indent: 20px;
}

#khthsoavbk .gt_indent_5 {
  text-indent: 25px;
}

#khthsoavbk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#khthsoavbk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal">A selected sample of the PITCHf/x data</th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Note: This is not all of the important columns, just a view for demonstration purposes.</th>
</tr>
<tr class="header gt_col_headings">
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="game_date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_date</th>
<th id="player_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">player_name</th>
<th id="balls" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">balls</th>
<th id="strikes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">strikes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">3</td>
<td class="gt_row gt_right" headers="strikes">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">2</td>
<td class="gt_row gt_right" headers="strikes">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">2</td>
<td class="gt_row gt_right" headers="strikes">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">2</td>
<td class="gt_row gt_right" headers="strikes">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
<td class="gt_row gt_left" headers="player_name">Buehler, Walker</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 1">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now you try!</p>
<ol type="1">
<li>First isolate the variables batter, pitcher, home_team, away_team, and game_date.</li>
<li>Then make sure that only the first 5 rows are visible</li>
<li>Lastly add a header that summarizes the information displayed.</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 1 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pitches <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(batter, pitcher, home_team, away_team, game_date) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"A selected sample of the PITCHf/x data"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"The table below includes the batter, pitcher, home_team, away_team, and game_date."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="kdadgrkcbk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kdadgrkcbk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kdadgrkcbk thead, #kdadgrkcbk tbody, #kdadgrkcbk tfoot, #kdadgrkcbk tr, #kdadgrkcbk td, #kdadgrkcbk th {
  border-style: none;
}

#kdadgrkcbk p {
  margin: 0;
  padding: 0;
}

#kdadgrkcbk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kdadgrkcbk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kdadgrkcbk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kdadgrkcbk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kdadgrkcbk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kdadgrkcbk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kdadgrkcbk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kdadgrkcbk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kdadgrkcbk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kdadgrkcbk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kdadgrkcbk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kdadgrkcbk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kdadgrkcbk .gt_spanner_row {
  border-bottom-style: hidden;
}

#kdadgrkcbk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kdadgrkcbk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kdadgrkcbk .gt_from_md > :first-child {
  margin-top: 0;
}

#kdadgrkcbk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kdadgrkcbk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kdadgrkcbk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kdadgrkcbk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kdadgrkcbk .gt_row_group_first td {
  border-top-width: 2px;
}

#kdadgrkcbk .gt_row_group_first th {
  border-top-width: 2px;
}

#kdadgrkcbk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kdadgrkcbk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kdadgrkcbk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kdadgrkcbk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kdadgrkcbk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kdadgrkcbk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kdadgrkcbk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kdadgrkcbk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kdadgrkcbk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kdadgrkcbk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kdadgrkcbk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kdadgrkcbk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kdadgrkcbk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kdadgrkcbk .gt_left {
  text-align: left;
}

#kdadgrkcbk .gt_center {
  text-align: center;
}

#kdadgrkcbk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kdadgrkcbk .gt_font_normal {
  font-weight: normal;
}

#kdadgrkcbk .gt_font_bold {
  font-weight: bold;
}

#kdadgrkcbk .gt_font_italic {
  font-style: italic;
}

#kdadgrkcbk .gt_super {
  font-size: 65%;
}

#kdadgrkcbk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kdadgrkcbk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kdadgrkcbk .gt_indent_1 {
  text-indent: 5px;
}

#kdadgrkcbk .gt_indent_2 {
  text-indent: 10px;
}

#kdadgrkcbk .gt_indent_3 {
  text-indent: 15px;
}

#kdadgrkcbk .gt_indent_4 {
  text-indent: 20px;
}

#kdadgrkcbk .gt_indent_5 {
  text-indent: 25px;
}

#kdadgrkcbk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kdadgrkcbk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal">A selected sample of the PITCHf/x data</th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">The table below includes the batter, pitcher, home_team, away_team, and game_date.</th>
</tr>
<tr class="header gt_col_headings">
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitcher" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitcher</th>
<th id="home_team" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">home_team</th>
<th id="away_team" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">away_team</th>
<th id="game_date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_date</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="batter">657077</td>
<td class="gt_row gt_right" headers="pitcher">621111</td>
<td class="gt_row gt_left" headers="home_team">NYY</td>
<td class="gt_row gt_left" headers="away_team">LAD</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="batter">657077</td>
<td class="gt_row gt_right" headers="pitcher">621111</td>
<td class="gt_row gt_left" headers="home_team">NYY</td>
<td class="gt_row gt_left" headers="away_team">LAD</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="batter">657077</td>
<td class="gt_row gt_right" headers="pitcher">621111</td>
<td class="gt_row gt_left" headers="home_team">NYY</td>
<td class="gt_row gt_left" headers="away_team">LAD</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="batter">657077</td>
<td class="gt_row gt_right" headers="pitcher">621111</td>
<td class="gt_row gt_left" headers="home_team">NYY</td>
<td class="gt_row gt_left" headers="away_team">LAD</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="batter">669224</td>
<td class="gt_row gt_right" headers="pitcher">621111</td>
<td class="gt_row gt_left" headers="home_team">NYY</td>
<td class="gt_row gt_left" headers="away_team">LAD</td>
<td class="gt_row gt_right" headers="game_date">2024-10-30</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-new-variables" class="level1 page-columns page-full">
<h1>Creating New Variables</h1>
<p>As we work through this next section, some questions to consider are:</p>
<ul>
<li>How should we clean the data?</li>
<li>What variables need to be considered?</li>
<li>What should be our response variable?</li>
<li>What outcomes are good for the pitcher?</li>
<li>What outcomes benefit the batter?</li>
</ul>
<p>Since our aim is to find what pitch sequences, if any, lead to the greatest pitch success, we first need to define what success is for the scope of our project. We call any of these outcomes <strong>successful</strong> for the reasons to follow: swinging strike, called strike, foul tip, swinging strike blocked, foul, foul bunt, missed bunt, and bunt foul tip. These can be considered successful for the pitcher because they all count as a strike for the batter without putting the ball into play. Effectively, the pitcher gains an upper hand on the batter and progresses in the count when one of these occur. Alternatively, other outcomes such as a hit or a ball will be considered unsuccessful since the batter either succeeds putting the ball into play or gets another step towards a hitter’s count. Remember: <strong>we are considering a “success” from a pitcher’s perspective</strong>.</p>
<p>Now let’s <strong>create a success variable</strong>. We will consider a success whether a pitch results in a strike or not. Since foul balls result from less than ideal contact with the bat, we will consider those successful from the pitcher’s perspective. The rest of the included descriptions follow this logic and refer to successful pitches.</p>
<p>To determine the values we want to pull out for success, we need to look at the different options available to us in the data. To do this we can run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(pitches<span class="sc">$</span>description)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "swinging_strike_blocked" "swinging_strike"        
 [3] "ball"                    "foul"                   
 [5] "called_strike"           "hit_into_play"          
 [7] "blocked_ball"            "foul_tip"               
 [9] "foul_bunt"               "hit_by_pitch"           
[11] "missed_bunt"             "bunt_foul_tip"          
[13] "pitchout"               </code></pre>
</div>
</div>
<p>Looking at the list of descriptions provided by the output we can begin to determine the descriptions we would consider success from the pitchers view.</p>
<p>In order to create a new variable we will use the mutate function. Within mutate, you start by creating a name for your new variable and setting it equal to the rule or formula you want it to become. For “success”, we want all pitches with a description of: swinging_strike, called_strike, foul_tip, swinging_strike_blocked, foul, foul_bunt, missed_bunt, bunt_foul_tip, to be considered a success designated by a “1” and any other description to be considered a failure designated by a “0”. It is important to make these binary, so that we can easily calculate the percent of successful pitches.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pitches <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success =</span> <span class="fu">if_else</span>(description <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"swinging_strike"</span>, <span class="st">"called_strike"</span>, <span class="st">"foul_tip"</span>, <span class="st">"swinging_strike_blocked"</span>, <span class="st">"foul"</span>, <span class="st">"foul_bunt"</span>, <span class="st">"missed_bunt"</span>, <span class="st">"bunt_foul_tip"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Consideration:</strong> As you work through this SCORE Module, consider the following: A well hit pitch that goes just foul can provide the batter a lot of confidence that they understand and can predict the pitcher. If we were to consider fouls “failures” for the pitcher rather than “successes”, how would our outputs change?</p>
</div></div><div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 2">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>What if we want to define success from the batters point of view. How would the above code change?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 2 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are two ways we can change success in order for it to be from the batter perspective. First we could redefine the descriptions that are successful:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pitches2 <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success =</span> <span class="fu">if_else</span>(description <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"hit_into_play"</span>, <span class="st">"ball"</span>, <span class="st">"hit_by_pitch"</span>, <span class="st">"blocked_ball"</span>, <span class="st">"pitchout"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(pitches2<span class="sc">$</span>description, pitches2<span class="sc">$</span>success))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]                      [,2]
[1,] "swinging_strike_blocked" "0" 
[2,] "swinging_strike"         "0" 
[3,] "swinging_strike"         "0" 
[4,] "ball"                    "1" 
[5,] "swinging_strike"         "0" 
[6,] "ball"                    "1" </code></pre>
</div>
</div>
<p>Or an easier solution, but less intuitive, we could have simply switched the 0s and 1s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pitches2 <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success =</span> <span class="fu">if_else</span>(description <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"swinging_strike"</span>, <span class="st">"called_strike"</span>, <span class="st">"foul_tip"</span>, <span class="st">"swinging_strike_blocked"</span>, <span class="st">"foul"</span>, <span class="st">"foul_bunt"</span>, <span class="st">"missed_bunt"</span>, <span class="st">"bunt_foul_tip"</span>), <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(pitches2<span class="sc">$</span>description, pitches2<span class="sc">$</span>success))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]                      [,2]
[1,] "swinging_strike_blocked" "0" 
[2,] "swinging_strike"         "0" 
[3,] "swinging_strike"         "0" 
[4,] "ball"                    "1" 
[5,] "swinging_strike"         "0" 
[6,] "ball"                    "1" </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>With the success variable established, we’ll take a brief look at the pitch types and their success rate in the data. We want to create a table that shows us the probability of success for each of the pitch types observed. In order to do this we will need to use the group_by() function in order to subset the data by pitch_type. Then the summarise function allows us to view the total pitches in each pitch type and calculating the mean of success allows us to see the proportion of time each pitch_type was successful. Then using total_pitches we can use mutate to add a new column for success_rate. Lastly, the arrange() function allows the user to order the information by success rate and the minus forces it to be descending.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pitch_type_success <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pitch_type) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_pitches =</span> <span class="fu">n</span>(),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">success_rate =</span> <span class="fu">round</span>(<span class="fu">mean</span>(success), <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_total_pitches =</span> <span class="fu">round</span>((<span class="dv">100</span> <span class="sc">*</span> total_pitches <span class="sc">/</span> <span class="fu">sum</span>(total_pitches)), <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>success_rate)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>pitch_type_success <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Pitch Type"</span>, <span class="st">"Success rate and Percent of Occurence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="nwyawdbzrw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nwyawdbzrw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nwyawdbzrw thead, #nwyawdbzrw tbody, #nwyawdbzrw tfoot, #nwyawdbzrw tr, #nwyawdbzrw td, #nwyawdbzrw th {
  border-style: none;
}

#nwyawdbzrw p {
  margin: 0;
  padding: 0;
}

#nwyawdbzrw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nwyawdbzrw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nwyawdbzrw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nwyawdbzrw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nwyawdbzrw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwyawdbzrw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwyawdbzrw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwyawdbzrw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nwyawdbzrw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nwyawdbzrw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nwyawdbzrw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nwyawdbzrw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nwyawdbzrw .gt_spanner_row {
  border-bottom-style: hidden;
}

#nwyawdbzrw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nwyawdbzrw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nwyawdbzrw .gt_from_md > :first-child {
  margin-top: 0;
}

#nwyawdbzrw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nwyawdbzrw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nwyawdbzrw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nwyawdbzrw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nwyawdbzrw .gt_row_group_first td {
  border-top-width: 2px;
}

#nwyawdbzrw .gt_row_group_first th {
  border-top-width: 2px;
}

#nwyawdbzrw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwyawdbzrw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nwyawdbzrw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nwyawdbzrw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwyawdbzrw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwyawdbzrw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nwyawdbzrw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nwyawdbzrw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nwyawdbzrw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwyawdbzrw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwyawdbzrw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwyawdbzrw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwyawdbzrw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwyawdbzrw .gt_left {
  text-align: left;
}

#nwyawdbzrw .gt_center {
  text-align: center;
}

#nwyawdbzrw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nwyawdbzrw .gt_font_normal {
  font-weight: normal;
}

#nwyawdbzrw .gt_font_bold {
  font-weight: bold;
}

#nwyawdbzrw .gt_font_italic {
  font-style: italic;
}

#nwyawdbzrw .gt_super {
  font-size: 65%;
}

#nwyawdbzrw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nwyawdbzrw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nwyawdbzrw .gt_indent_1 {
  text-indent: 5px;
}

#nwyawdbzrw .gt_indent_2 {
  text-indent: 10px;
}

#nwyawdbzrw .gt_indent_3 {
  text-indent: 15px;
}

#nwyawdbzrw .gt_indent_4 {
  text-indent: 20px;
}

#nwyawdbzrw .gt_indent_5 {
  text-indent: 25px;
}

#nwyawdbzrw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nwyawdbzrw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Pitch Type</th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Success rate and Percent of Occurence</th>
</tr>
<tr class="header gt_col_headings">
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_pitches</th>
<th id="success_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_rate</th>
<th id="percent_total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percent_total_pitches</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_right" headers="total_pitches">224988</td>
<td class="gt_row gt_right" headers="success_rate">0.4992</td>
<td class="gt_row gt_right" headers="percent_total_pitches">31.8803</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FO</td>
<td class="gt_row gt_right" headers="total_pitches">144</td>
<td class="gt_row gt_right" headers="success_rate">0.4931</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0204</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">NA</td>
<td class="gt_row gt_right" headers="total_pitches">285</td>
<td class="gt_row gt_right" headers="success_rate">0.4877</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0404</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_right" headers="total_pitches">56762</td>
<td class="gt_row gt_right" headers="success_rate">0.4714</td>
<td class="gt_row gt_right" headers="percent_total_pitches">8.0430</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_right" headers="total_pitches">111957</td>
<td class="gt_row gt_right" headers="success_rate">0.4683</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8640</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_right" headers="total_pitches">112013</td>
<td class="gt_row gt_right" headers="success_rate">0.4680</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8720</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="total_pitches">11749</td>
<td class="gt_row gt_right" headers="success_rate">0.4592</td>
<td class="gt_row gt_right" headers="percent_total_pitches">1.6648</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_right" headers="total_pitches">46241</td>
<td class="gt_row gt_right" headers="success_rate">0.4568</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.5522</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">ST</td>
<td class="gt_row gt_right" headers="total_pitches">43349</td>
<td class="gt_row gt_right" headers="success_rate">0.4560</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.1425</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SV</td>
<td class="gt_row gt_right" headers="total_pitches">2651</td>
<td class="gt_row gt_right" headers="success_rate">0.4489</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.3756</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FS</td>
<td class="gt_row gt_right" headers="total_pitches">21218</td>
<td class="gt_row gt_right" headers="success_rate">0.4223</td>
<td class="gt_row gt_right" headers="percent_total_pitches">3.0065</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KN</td>
<td class="gt_row gt_right" headers="total_pitches">971</td>
<td class="gt_row gt_right" headers="success_rate">0.4161</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.1376</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_right" headers="total_pitches">71945</td>
<td class="gt_row gt_right" headers="success_rate">0.4061</td>
<td class="gt_row gt_right" headers="percent_total_pitches">10.1944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SC</td>
<td class="gt_row gt_right" headers="total_pitches">182</td>
<td class="gt_row gt_right" headers="success_rate">0.3736</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0258</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">CS</td>
<td class="gt_row gt_right" headers="total_pitches">21</td>
<td class="gt_row gt_right" headers="success_rate">0.3333</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0030</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FA</td>
<td class="gt_row gt_right" headers="total_pitches">626</td>
<td class="gt_row gt_right" headers="success_rate">0.3307</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0887</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">EP</td>
<td class="gt_row gt_right" headers="total_pitches">575</td>
<td class="gt_row gt_right" headers="success_rate">0.2609</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0815</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">PO</td>
<td class="gt_row gt_right" headers="total_pitches">51</td>
<td class="gt_row gt_right" headers="success_rate">0.0000</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0072</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 3">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>What if we want pitch type to be ordered by percent_total_pitches descending? What do we need to change to make this happen?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 3 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to do this, the only line of code that needed to be changed was that last one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pitch_type_success2 <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pitch_type) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_pitches =</span> <span class="fu">n</span>(),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">success_rate =</span> <span class="fu">round</span>(<span class="fu">mean</span>(success), <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_total_pitches =</span> <span class="fu">round</span>((<span class="dv">100</span> <span class="sc">*</span> total_pitches <span class="sc">/</span> <span class="fu">sum</span>(total_pitches)), <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>percent_total_pitches)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>pitch_type_success2 <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Pitch Type"</span>, <span class="st">"Success rate and Percent of Occurence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="qfykzpwszb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qfykzpwszb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qfykzpwszb thead, #qfykzpwszb tbody, #qfykzpwszb tfoot, #qfykzpwszb tr, #qfykzpwszb td, #qfykzpwszb th {
  border-style: none;
}

#qfykzpwszb p {
  margin: 0;
  padding: 0;
}

#qfykzpwszb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qfykzpwszb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qfykzpwszb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qfykzpwszb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qfykzpwszb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qfykzpwszb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfykzpwszb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qfykzpwszb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qfykzpwszb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qfykzpwszb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qfykzpwszb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qfykzpwszb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qfykzpwszb .gt_spanner_row {
  border-bottom-style: hidden;
}

#qfykzpwszb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qfykzpwszb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qfykzpwszb .gt_from_md > :first-child {
  margin-top: 0;
}

#qfykzpwszb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qfykzpwszb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qfykzpwszb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qfykzpwszb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qfykzpwszb .gt_row_group_first td {
  border-top-width: 2px;
}

#qfykzpwszb .gt_row_group_first th {
  border-top-width: 2px;
}

#qfykzpwszb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfykzpwszb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qfykzpwszb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qfykzpwszb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfykzpwszb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfykzpwszb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qfykzpwszb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qfykzpwszb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qfykzpwszb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfykzpwszb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qfykzpwszb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfykzpwszb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qfykzpwszb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfykzpwszb .gt_left {
  text-align: left;
}

#qfykzpwszb .gt_center {
  text-align: center;
}

#qfykzpwszb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qfykzpwszb .gt_font_normal {
  font-weight: normal;
}

#qfykzpwszb .gt_font_bold {
  font-weight: bold;
}

#qfykzpwszb .gt_font_italic {
  font-style: italic;
}

#qfykzpwszb .gt_super {
  font-size: 65%;
}

#qfykzpwszb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qfykzpwszb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qfykzpwszb .gt_indent_1 {
  text-indent: 5px;
}

#qfykzpwszb .gt_indent_2 {
  text-indent: 10px;
}

#qfykzpwszb .gt_indent_3 {
  text-indent: 15px;
}

#qfykzpwszb .gt_indent_4 {
  text-indent: 20px;
}

#qfykzpwszb .gt_indent_5 {
  text-indent: 25px;
}

#qfykzpwszb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qfykzpwszb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Pitch Type</th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Success rate and Percent of Occurence</th>
</tr>
<tr class="header gt_col_headings">
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_pitches</th>
<th id="success_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_rate</th>
<th id="percent_total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percent_total_pitches</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_right" headers="total_pitches">224988</td>
<td class="gt_row gt_right" headers="success_rate">0.4992</td>
<td class="gt_row gt_right" headers="percent_total_pitches">31.8803</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_right" headers="total_pitches">112013</td>
<td class="gt_row gt_right" headers="success_rate">0.4680</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8720</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_right" headers="total_pitches">111957</td>
<td class="gt_row gt_right" headers="success_rate">0.4683</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8640</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_right" headers="total_pitches">71945</td>
<td class="gt_row gt_right" headers="success_rate">0.4061</td>
<td class="gt_row gt_right" headers="percent_total_pitches">10.1944</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_right" headers="total_pitches">56762</td>
<td class="gt_row gt_right" headers="success_rate">0.4714</td>
<td class="gt_row gt_right" headers="percent_total_pitches">8.0430</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_right" headers="total_pitches">46241</td>
<td class="gt_row gt_right" headers="success_rate">0.4568</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.5522</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">ST</td>
<td class="gt_row gt_right" headers="total_pitches">43349</td>
<td class="gt_row gt_right" headers="success_rate">0.4560</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.1425</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FS</td>
<td class="gt_row gt_right" headers="total_pitches">21218</td>
<td class="gt_row gt_right" headers="success_rate">0.4223</td>
<td class="gt_row gt_right" headers="percent_total_pitches">3.0065</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="total_pitches">11749</td>
<td class="gt_row gt_right" headers="success_rate">0.4592</td>
<td class="gt_row gt_right" headers="percent_total_pitches">1.6648</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SV</td>
<td class="gt_row gt_right" headers="total_pitches">2651</td>
<td class="gt_row gt_right" headers="success_rate">0.4489</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.3756</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KN</td>
<td class="gt_row gt_right" headers="total_pitches">971</td>
<td class="gt_row gt_right" headers="success_rate">0.4161</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.1376</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FA</td>
<td class="gt_row gt_right" headers="total_pitches">626</td>
<td class="gt_row gt_right" headers="success_rate">0.3307</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0887</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">EP</td>
<td class="gt_row gt_right" headers="total_pitches">575</td>
<td class="gt_row gt_right" headers="success_rate">0.2609</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0815</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">NA</td>
<td class="gt_row gt_right" headers="total_pitches">285</td>
<td class="gt_row gt_right" headers="success_rate">0.4877</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0404</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">SC</td>
<td class="gt_row gt_right" headers="total_pitches">182</td>
<td class="gt_row gt_right" headers="success_rate">0.3736</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0258</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FO</td>
<td class="gt_row gt_right" headers="total_pitches">144</td>
<td class="gt_row gt_right" headers="success_rate">0.4931</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0204</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">PO</td>
<td class="gt_row gt_right" headers="total_pitches">51</td>
<td class="gt_row gt_right" headers="success_rate">0.0000</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0072</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">CS</td>
<td class="gt_row gt_right" headers="total_pitches">21</td>
<td class="gt_row gt_right" headers="success_rate">0.3333</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0030</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
<p>Something you may notice is that one of the rows is NA for Pitch Type. This is likely because it did not clearly fall into one of the categories. Therefore rather than leave it as NA, we can change the name to be “Other”. In order to do this we subset the data by using brackets and find every where there is currently NA, and replace it with “Other”. Using the unique() function we can verify that there are no longer NA entries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pitch_type_success<span class="sc">$</span>pitch_type[<span class="fu">is.na</span>(pitch_type_success<span class="sc">$</span>pitch_type)] <span class="ot">&lt;-</span> <span class="st">"Other"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(pitch_type_success<span class="sc">$</span>pitch_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FF"    "FO"    "Other" "FC"    "SL"    "SI"    "KC"    "CU"    "ST"   
[10] "SV"    "FS"    "KN"    "CH"    "SC"    "CS"    "FA"    "EP"    "PO"   </code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Consideration:</strong> We will going back to using our original dataframe “pitches” so it will be important to also run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pitches<span class="sc">$</span>pitch_type[<span class="fu">is.na</span>(pitches<span class="sc">$</span>pitch_type)] <span class="ot">&lt;-</span> <span class="st">"Other"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div><p>Now when we run the code from before, we can see the change in our table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pitch_type_success <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Pitch Type"</span>, <span class="st">"Success rate and Percent of Occurence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="evlxqfigzb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#evlxqfigzb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#evlxqfigzb thead, #evlxqfigzb tbody, #evlxqfigzb tfoot, #evlxqfigzb tr, #evlxqfigzb td, #evlxqfigzb th {
  border-style: none;
}

#evlxqfigzb p {
  margin: 0;
  padding: 0;
}

#evlxqfigzb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#evlxqfigzb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#evlxqfigzb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#evlxqfigzb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#evlxqfigzb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#evlxqfigzb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#evlxqfigzb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#evlxqfigzb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#evlxqfigzb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#evlxqfigzb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#evlxqfigzb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#evlxqfigzb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#evlxqfigzb .gt_spanner_row {
  border-bottom-style: hidden;
}

#evlxqfigzb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#evlxqfigzb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#evlxqfigzb .gt_from_md > :first-child {
  margin-top: 0;
}

#evlxqfigzb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#evlxqfigzb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#evlxqfigzb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#evlxqfigzb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#evlxqfigzb .gt_row_group_first td {
  border-top-width: 2px;
}

#evlxqfigzb .gt_row_group_first th {
  border-top-width: 2px;
}

#evlxqfigzb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#evlxqfigzb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#evlxqfigzb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#evlxqfigzb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#evlxqfigzb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#evlxqfigzb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#evlxqfigzb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#evlxqfigzb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#evlxqfigzb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#evlxqfigzb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#evlxqfigzb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#evlxqfigzb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#evlxqfigzb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#evlxqfigzb .gt_left {
  text-align: left;
}

#evlxqfigzb .gt_center {
  text-align: center;
}

#evlxqfigzb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#evlxqfigzb .gt_font_normal {
  font-weight: normal;
}

#evlxqfigzb .gt_font_bold {
  font-weight: bold;
}

#evlxqfigzb .gt_font_italic {
  font-style: italic;
}

#evlxqfigzb .gt_super {
  font-size: 65%;
}

#evlxqfigzb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#evlxqfigzb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#evlxqfigzb .gt_indent_1 {
  text-indent: 5px;
}

#evlxqfigzb .gt_indent_2 {
  text-indent: 10px;
}

#evlxqfigzb .gt_indent_3 {
  text-indent: 15px;
}

#evlxqfigzb .gt_indent_4 {
  text-indent: 20px;
}

#evlxqfigzb .gt_indent_5 {
  text-indent: 25px;
}

#evlxqfigzb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#evlxqfigzb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Pitch Type</th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Success rate and Percent of Occurence</th>
</tr>
<tr class="header gt_col_headings">
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_pitches</th>
<th id="success_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_rate</th>
<th id="percent_total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percent_total_pitches</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_right" headers="total_pitches">224988</td>
<td class="gt_row gt_right" headers="success_rate">0.4992</td>
<td class="gt_row gt_right" headers="percent_total_pitches">31.8803</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FO</td>
<td class="gt_row gt_right" headers="total_pitches">144</td>
<td class="gt_row gt_right" headers="success_rate">0.4931</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0204</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">Other</td>
<td class="gt_row gt_right" headers="total_pitches">285</td>
<td class="gt_row gt_right" headers="success_rate">0.4877</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0404</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_right" headers="total_pitches">56762</td>
<td class="gt_row gt_right" headers="success_rate">0.4714</td>
<td class="gt_row gt_right" headers="percent_total_pitches">8.0430</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_right" headers="total_pitches">111957</td>
<td class="gt_row gt_right" headers="success_rate">0.4683</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8640</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_right" headers="total_pitches">112013</td>
<td class="gt_row gt_right" headers="success_rate">0.4680</td>
<td class="gt_row gt_right" headers="percent_total_pitches">15.8720</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">KC</td>
<td class="gt_row gt_right" headers="total_pitches">11749</td>
<td class="gt_row gt_right" headers="success_rate">0.4592</td>
<td class="gt_row gt_right" headers="percent_total_pitches">1.6648</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_right" headers="total_pitches">46241</td>
<td class="gt_row gt_right" headers="success_rate">0.4568</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.5522</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">ST</td>
<td class="gt_row gt_right" headers="total_pitches">43349</td>
<td class="gt_row gt_right" headers="success_rate">0.4560</td>
<td class="gt_row gt_right" headers="percent_total_pitches">6.1425</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SV</td>
<td class="gt_row gt_right" headers="total_pitches">2651</td>
<td class="gt_row gt_right" headers="success_rate">0.4489</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.3756</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">FS</td>
<td class="gt_row gt_right" headers="total_pitches">21218</td>
<td class="gt_row gt_right" headers="success_rate">0.4223</td>
<td class="gt_row gt_right" headers="percent_total_pitches">3.0065</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">KN</td>
<td class="gt_row gt_right" headers="total_pitches">971</td>
<td class="gt_row gt_right" headers="success_rate">0.4161</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.1376</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_right" headers="total_pitches">71945</td>
<td class="gt_row gt_right" headers="success_rate">0.4061</td>
<td class="gt_row gt_right" headers="percent_total_pitches">10.1944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">SC</td>
<td class="gt_row gt_right" headers="total_pitches">182</td>
<td class="gt_row gt_right" headers="success_rate">0.3736</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0258</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">CS</td>
<td class="gt_row gt_right" headers="total_pitches">21</td>
<td class="gt_row gt_right" headers="success_rate">0.3333</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0030</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">FA</td>
<td class="gt_row gt_right" headers="total_pitches">626</td>
<td class="gt_row gt_right" headers="success_rate">0.3307</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0887</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_type">EP</td>
<td class="gt_row gt_right" headers="total_pitches">575</td>
<td class="gt_row gt_right" headers="success_rate">0.2609</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0815</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_type">PO</td>
<td class="gt_row gt_right" headers="total_pitches">51</td>
<td class="gt_row gt_right" headers="success_rate">0.0000</td>
<td class="gt_row gt_right" headers="percent_total_pitches">0.0072</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It is important to note that each pitch type has a varying level of frequency in the data. Most commonly, we observe “FF” - four seam fastballs, and infrequently we see “FO” - forkballs.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Consideration:</strong> This imbalance in pitch type frequency should be noted as we continue as it may have a significant effect on our results.</p>
</div></div><p>Furthermore, we notice very similar overall success rates for each pitch type. This is to be expected since if one pitch showed an observable advantage, all pitchers would begin throwing that pitch type more often and batters would adjust accordingly. This system is likely to balance out in all pitches being similarly effective as shown.</p>
<p>Our inspection of the pitches shows us that the data set includes <strong>18 different types of pitches</strong>, including the previously blank one that we redefined as “Other”. We need to <strong>reduce the number of pitch types</strong> in order to keep our analysis comprehensible. This is because in pitch sequencing, the order of pitch types matter (as the name would suggest), so the number of possible three pitch sequences would follow the formula for permutations with replacement (as opposed to combinations which do not depend on order): The number of possible sequences is equal to the number of pitch types raised to the number of pitches thrown. This means that we would get 5,832 possible three pitch sequences from the 18 possible categories. In an effort to reduce this, we will combine pitch types into more general categories.</p>
<p>As we continue to work through this section, some questions to consider are:</p>
<ul>
<li>What is a reasonable number of pitch sequences that you would like to analyze?</li>
<li>Which pitch sequence do you think would perform the best?</li>
<li>Which do you think is the most common?</li>
</ul>
<p>To reduce the number of sequences, we group many pitch types into categories based on similarities. For example, two-seam fastballs and four-seam fastballs are quite similar, so they will be grouped together. The chosen groups are ‘Fastballs’, ‘Breaking Balls’, ‘Off-Speeds’, and ‘Other’. Below is an explanation of the 18 pitch types and their chosen designation.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Consideration:</strong> Our pitch designation is not universally agreed upon.</p>
</div></div><div class="callout callout-style-simple callout-note no-icon callout-titled" title="Pitch Type and Categories">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pitch Type and Categories
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Fastballs</strong></p>
<ul>
<li>FF: Four-seam fastball</li>
<li>FA: Fastball</li>
<li>SI: Sinker (two-seam fastball)</li>
<li>FC: Cutter (Cut-fastball)</li>
</ul>
<p><strong>Breaking Ball</strong></p>
<ul>
<li>SL: Slider</li>
<li>CU: Curveball</li>
<li>KC: Knuckle curve ball</li>
<li>ST: Sweeper</li>
<li>SV: Slurve</li>
<li>SC: Screwball</li>
<li>CS: Slow Curve</li>
</ul>
<p><strong>Off-Speed</strong></p>
<ul>
<li>CH: Changeup</li>
<li>FS: Split-finger fastball</li>
<li>FO: Forkball</li>
<li>EP: Eephus</li>
<li>KN: Knuckleball</li>
</ul>
<p><strong>Other</strong></p>
<ul>
<li>PO: Pitch-out</li>
<li>Other: originally listed as NA</li>
</ul>
<p>For more information please visit (<a href="https://www.mlb.com/glossary/pitch-types" class="uri">https://www.mlb.com/glossary/pitch-types</a>).</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pitches <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pitch_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FF"</span>, <span class="st">"FA"</span>, <span class="st">"SI"</span>, <span class="st">"FC"</span>) <span class="sc">~</span> <span class="st">"Fastball"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SL"</span>, <span class="st">"CU"</span>, <span class="st">"KC"</span>, <span class="st">"ST"</span>, <span class="st">"SV"</span>, <span class="st">"SC"</span>, <span class="st">"CS"</span>) <span class="sc">~</span> <span class="st">"Breaking Ball"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CH"</span>, <span class="st">"FS"</span>, <span class="st">"FO"</span>, <span class="st">"EP"</span>, <span class="st">"KN"</span>) <span class="sc">~</span> <span class="st">"Off-Speed"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PO"</span>, <span class="st">"Other"</span>) <span class="sc">~</span> <span class="st">"Other"</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>pitches <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pitch_category) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>percent)  <span class="sc">%&gt;%</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"New Pitch Categories"</span>, <span class="st">"Percent of observations in each category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="rhcboikhxx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rhcboikhxx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rhcboikhxx thead, #rhcboikhxx tbody, #rhcboikhxx tfoot, #rhcboikhxx tr, #rhcboikhxx td, #rhcboikhxx th {
  border-style: none;
}

#rhcboikhxx p {
  margin: 0;
  padding: 0;
}

#rhcboikhxx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rhcboikhxx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rhcboikhxx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rhcboikhxx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rhcboikhxx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rhcboikhxx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhcboikhxx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rhcboikhxx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rhcboikhxx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rhcboikhxx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rhcboikhxx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rhcboikhxx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rhcboikhxx .gt_spanner_row {
  border-bottom-style: hidden;
}

#rhcboikhxx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rhcboikhxx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rhcboikhxx .gt_from_md > :first-child {
  margin-top: 0;
}

#rhcboikhxx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rhcboikhxx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rhcboikhxx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rhcboikhxx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rhcboikhxx .gt_row_group_first td {
  border-top-width: 2px;
}

#rhcboikhxx .gt_row_group_first th {
  border-top-width: 2px;
}

#rhcboikhxx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhcboikhxx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rhcboikhxx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rhcboikhxx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhcboikhxx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhcboikhxx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rhcboikhxx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rhcboikhxx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rhcboikhxx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rhcboikhxx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rhcboikhxx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhcboikhxx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rhcboikhxx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rhcboikhxx .gt_left {
  text-align: left;
}

#rhcboikhxx .gt_center {
  text-align: center;
}

#rhcboikhxx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rhcboikhxx .gt_font_normal {
  font-weight: normal;
}

#rhcboikhxx .gt_font_bold {
  font-weight: bold;
}

#rhcboikhxx .gt_font_italic {
  font-style: italic;
}

#rhcboikhxx .gt_super {
  font-size: 65%;
}

#rhcboikhxx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rhcboikhxx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rhcboikhxx .gt_indent_1 {
  text-indent: 5px;
}

#rhcboikhxx .gt_indent_2 {
  text-indent: 10px;
}

#rhcboikhxx .gt_indent_3 {
  text-indent: 15px;
}

#rhcboikhxx .gt_indent_4 {
  text-indent: 20px;
}

#rhcboikhxx .gt_indent_5 {
  text-indent: 25px;
}

#rhcboikhxx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rhcboikhxx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">New Pitch Categories</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Percent of observations in each category</th>
</tr>
<tr class="header gt_col_headings">
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="count" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">count</th>
<th id="percent" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percent</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_right" headers="count">394389</td>
<td class="gt_row gt_right" headers="percent">55.88399497</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_right" headers="count">216150</td>
<td class="gt_row gt_right" headers="percent">30.62794731</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_right" headers="count">94853</td>
<td class="gt_row gt_right" headers="percent">13.44044731</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_category">Other</td>
<td class="gt_row gt_right" headers="count">336</td>
<td class="gt_row gt_right" headers="percent">0.04761041</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It is worth noting that there is a moderate imbalance in the number of examples we are working with for each pitch category. This may be an issue later on when we use logistic regression and will be discussed then. With the “Other” category making up less than 0.5% of the pitches, we will ultimately discard it from consideration. Furthermore, the “Other” category is comprised of pitch-outs and undefined pitches, which are not valuable for our intended analysis. With the remaining three categories, we will now have a total of 27 unique pitch sequences.</p>
</section>
<section id="transition-matrix" class="level1 page-columns page-full">
<h1>Transition Matrix</h1>
<p>As we work through this next section, there is one main question we will be working to answer:</p>
<ul>
<li>How do we determine the next pitch knowing the previous two?</li>
</ul>
<p>In a transition matrix, the rows represent your current state and the columns represent your future state. Within a transition matrix are probabilities that denote your ability to move from your current state to the future state.</p>
<p><span class="math display">\[P_{ij} = P(\text{future state} = j| \text{current state} = i)\]</span></p>
<p>Since a transition matrix is a markov process, a key assumption is that the process is memoryless. This means that given your current state, the future event’s probability does not depend on how you arrived at your current state. In terms of baseball pitching, this means that the process does not treat a batter arriving at a 3-2 count differently if in previous states it was 0-2 and fought their way back, or if they were 3-0 and watched two strikes down the pipe. However, since this is only preliminary analysis we are not concerned with this limitation and are still able to learn a lot about pitch sequencing.</p>
<p>For our first investigation, we want to see what pitch is most likely to happen given the first two. We will do this by <strong>separating consecutive 3-pitch sequences in the data that occurred on the same at bat</strong>. Furthermore, this means that a 4-pitch at-bat would create two sets of three, the first three pitches as one “triplet” and the last three pitches as a second “triplet”. After creating these triplets, we will create a transition matrix to investigate the probability of the next pitch given the first two.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Question:**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Question:</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>What are the pros and cons to using a shorter sequence? Why three pitches instead of four or more?</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Answer:**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Answer:</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Longer strings of pitches create exponentially more combinations of pitch sequences. Additionally, there will be fewer data points of four or more pitches in a row. Furthermore, any strikeout, which is a success for a pitcher, has a minimum of three pitches.</p>
</div>
</div>
</div>
<p>First, we need to <strong>take out any anomaly pitch or event within it</strong> such as bunts and pitch-outs since those are inherently different than traditional swings/pitches and very much situationally dependent. At this time we will also remove the “Other” category as mentioned in the previous section.</p>
<p>First we created a vector of the descriptions we will remove from consideration: foul bunt, missed bunt, bunt foul tip, and pitchout. Then we filtered the data so that it only included the data that did not have these descriptions or that were not classified as other. When coding in R, “!” acts as not. Thus, “!=” can be read as not equal to. We verify that the “Other” category has been removed by using the unique function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>exclude_desc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"foul_bunt"</span>, <span class="st">"missed_bunt"</span>, <span class="st">"bunt_foul_tip"</span>, <span class="st">"pitchout"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>pitches_clean <span class="ot">&lt;-</span> pitches <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>description <span class="sc">%in%</span> exclude_desc, pitch_category  <span class="sc">!=</span> <span class="st">"Other"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(pitches_clean<span class="sc">$</span>pitch_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Breaking Ball" "Fastball"      "Off-Speed"    </code></pre>
</div>
</div>
<p>Now we create a new dataframe with information we might want concerning pitch sequences. We first arrange the data by game date, gamepk (which is a game identifier), at_bat_number, and pitch number (which is by batter). This ensures that regardless of how the data was organized previously the order will now be in the order we need for pitch sequencing appropriately. Then we selected variables that might be of interest later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pitch_seq <span class="ot">&lt;-</span> pitches_clean <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(game_date, game_pk, at_bat_number, pitch_number) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_date, game_pk, at_bat_number, inning_topbot, inning, batter, pitch_number, balls, strikes, outs_when_up, description, pitch_type, pitch_category, player_name, pitcher, events, success, plate_x, plate_z)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(game_date, game_pk, at_bat_number, inning_topbot, inning, batter, pitch_number, balls, strikes, outs_when_up, description, pitch_type, pitch_category, events) <span class="sc">%&gt;%</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Pitch Sequence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ukeascgkjl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ukeascgkjl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ukeascgkjl thead, #ukeascgkjl tbody, #ukeascgkjl tfoot, #ukeascgkjl tr, #ukeascgkjl td, #ukeascgkjl th {
  border-style: none;
}

#ukeascgkjl p {
  margin: 0;
  padding: 0;
}

#ukeascgkjl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ukeascgkjl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ukeascgkjl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ukeascgkjl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ukeascgkjl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ukeascgkjl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukeascgkjl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ukeascgkjl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ukeascgkjl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ukeascgkjl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ukeascgkjl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ukeascgkjl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ukeascgkjl .gt_spanner_row {
  border-bottom-style: hidden;
}

#ukeascgkjl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ukeascgkjl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ukeascgkjl .gt_from_md > :first-child {
  margin-top: 0;
}

#ukeascgkjl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ukeascgkjl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ukeascgkjl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ukeascgkjl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ukeascgkjl .gt_row_group_first td {
  border-top-width: 2px;
}

#ukeascgkjl .gt_row_group_first th {
  border-top-width: 2px;
}

#ukeascgkjl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukeascgkjl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ukeascgkjl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ukeascgkjl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukeascgkjl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukeascgkjl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ukeascgkjl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ukeascgkjl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ukeascgkjl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ukeascgkjl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ukeascgkjl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukeascgkjl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ukeascgkjl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ukeascgkjl .gt_left {
  text-align: left;
}

#ukeascgkjl .gt_center {
  text-align: center;
}

#ukeascgkjl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ukeascgkjl .gt_font_normal {
  font-weight: normal;
}

#ukeascgkjl .gt_font_bold {
  font-weight: bold;
}

#ukeascgkjl .gt_font_italic {
  font-style: italic;
}

#ukeascgkjl .gt_super {
  font-size: 65%;
}

#ukeascgkjl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ukeascgkjl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ukeascgkjl .gt_indent_1 {
  text-indent: 5px;
}

#ukeascgkjl .gt_indent_2 {
  text-indent: 10px;
}

#ukeascgkjl .gt_indent_3 {
  text-indent: 15px;
}

#ukeascgkjl .gt_indent_4 {
  text-indent: 20px;
}

#ukeascgkjl .gt_indent_5 {
  text-indent: 25px;
}

#ukeascgkjl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ukeascgkjl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="14" class="gt_heading gt_title gt_font_normal gt_bottom_border">Pitch Sequence</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_date</th>
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="inning_topbot" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">inning_topbot</th>
<th id="inning" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">inning</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="balls" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">balls</th>
<th id="strikes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">strikes</th>
<th id="outs_when_up" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">outs_when_up</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="events" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">events</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">1</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_right" headers="balls">2</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_right" headers="balls">3</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">2</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">668804</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">2</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">668804</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">single</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">blocked_ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_right" headers="balls">2</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_right" headers="balls">3</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">walk</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">2</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">2</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
<td class="gt_row gt_right" headers="outs_when_up">2</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In order to understand how we can create three-pitch sequences, lets start by looking at the sequence for batter 457705 from the table above. We can see that this batter had five pitches thrown before he struck out. Five pitches thrown means we have a set of 3 three pitch sequences we can look at just for this at bat (1-2-3, 2-3-4, and 3-4-5). So how do we get these sequences?</p>
<p>First for investigation purposes I subset the data just to look at this batters 5 pitches. Then I grouped the data by game_pk and at_bat_number so that when we expand past this small subset we will be able to do this for every combination of game and batter. Then I created three new variables in my dataset, first_pitch, second pitch, and third pitch. The lag() function looks back a designated amount of rows and sets whatever variable that was designated there. For example, “first_pitch = lag(pitch_category, 2)” says go back two rows and designate the pitch category two rows back as the first pitch. Realize that this will be NA until the third pitch has happened.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>small <span class="ot">&lt;-</span> pitch_seq[<span class="dv">13</span><span class="sc">:</span><span class="dv">17</span>,]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>small <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_date, game_pk, at_bat_number, inning_topbot, inning, batter, pitch_number, balls, strikes, outs_when_up, description, pitch_type, pitch_category, events) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Batter 457705 for Game 744875"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fdnkdpnxrp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fdnkdpnxrp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fdnkdpnxrp thead, #fdnkdpnxrp tbody, #fdnkdpnxrp tfoot, #fdnkdpnxrp tr, #fdnkdpnxrp td, #fdnkdpnxrp th {
  border-style: none;
}

#fdnkdpnxrp p {
  margin: 0;
  padding: 0;
}

#fdnkdpnxrp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fdnkdpnxrp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fdnkdpnxrp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fdnkdpnxrp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fdnkdpnxrp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fdnkdpnxrp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdnkdpnxrp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fdnkdpnxrp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fdnkdpnxrp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fdnkdpnxrp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fdnkdpnxrp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fdnkdpnxrp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fdnkdpnxrp .gt_spanner_row {
  border-bottom-style: hidden;
}

#fdnkdpnxrp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fdnkdpnxrp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fdnkdpnxrp .gt_from_md > :first-child {
  margin-top: 0;
}

#fdnkdpnxrp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fdnkdpnxrp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fdnkdpnxrp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fdnkdpnxrp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fdnkdpnxrp .gt_row_group_first td {
  border-top-width: 2px;
}

#fdnkdpnxrp .gt_row_group_first th {
  border-top-width: 2px;
}

#fdnkdpnxrp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdnkdpnxrp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fdnkdpnxrp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fdnkdpnxrp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdnkdpnxrp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdnkdpnxrp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fdnkdpnxrp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fdnkdpnxrp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fdnkdpnxrp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fdnkdpnxrp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fdnkdpnxrp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdnkdpnxrp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fdnkdpnxrp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fdnkdpnxrp .gt_left {
  text-align: left;
}

#fdnkdpnxrp .gt_center {
  text-align: center;
}

#fdnkdpnxrp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fdnkdpnxrp .gt_font_normal {
  font-weight: normal;
}

#fdnkdpnxrp .gt_font_bold {
  font-weight: bold;
}

#fdnkdpnxrp .gt_font_italic {
  font-style: italic;
}

#fdnkdpnxrp .gt_super {
  font-size: 65%;
}

#fdnkdpnxrp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fdnkdpnxrp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fdnkdpnxrp .gt_indent_1 {
  text-indent: 5px;
}

#fdnkdpnxrp .gt_indent_2 {
  text-indent: 10px;
}

#fdnkdpnxrp .gt_indent_3 {
  text-indent: 15px;
}

#fdnkdpnxrp .gt_indent_4 {
  text-indent: 20px;
}

#fdnkdpnxrp .gt_indent_5 {
  text-indent: 25px;
}

#fdnkdpnxrp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fdnkdpnxrp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="14" class="gt_heading gt_title gt_font_normal gt_bottom_border">Batter 457705 for Game 744875</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_date</th>
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="inning_topbot" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">inning_topbot</th>
<th id="inning" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">inning</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="balls" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">balls</th>
<th id="strikes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">strikes</th>
<th id="outs_when_up" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">outs_when_up</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="events" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">events</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">1</td>
<td class="gt_row gt_right" headers="balls">0</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">2</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">0</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">1</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_date">2024-04-01</td>
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_left" headers="inning_topbot">Top</td>
<td class="gt_row gt_right" headers="inning">1</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_right" headers="balls">1</td>
<td class="gt_row gt_right" headers="strikes">2</td>
<td class="gt_row gt_right" headers="outs_when_up">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>small <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch =</span> pitch_category</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_pk, at_bat_number, batter, pitch_number, pitch_type, pitch_category, first_pitch, second_pitch, third_pitch)  <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Pitch Sequence for Batter 457705"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bfqgsnstqt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bfqgsnstqt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bfqgsnstqt thead, #bfqgsnstqt tbody, #bfqgsnstqt tfoot, #bfqgsnstqt tr, #bfqgsnstqt td, #bfqgsnstqt th {
  border-style: none;
}

#bfqgsnstqt p {
  margin: 0;
  padding: 0;
}

#bfqgsnstqt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bfqgsnstqt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bfqgsnstqt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bfqgsnstqt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bfqgsnstqt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfqgsnstqt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfqgsnstqt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfqgsnstqt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bfqgsnstqt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bfqgsnstqt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bfqgsnstqt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bfqgsnstqt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bfqgsnstqt .gt_spanner_row {
  border-bottom-style: hidden;
}

#bfqgsnstqt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bfqgsnstqt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bfqgsnstqt .gt_from_md > :first-child {
  margin-top: 0;
}

#bfqgsnstqt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bfqgsnstqt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bfqgsnstqt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqgsnstqt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bfqgsnstqt .gt_row_group_first td {
  border-top-width: 2px;
}

#bfqgsnstqt .gt_row_group_first th {
  border-top-width: 2px;
}

#bfqgsnstqt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqgsnstqt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bfqgsnstqt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bfqgsnstqt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfqgsnstqt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqgsnstqt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bfqgsnstqt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bfqgsnstqt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bfqgsnstqt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfqgsnstqt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfqgsnstqt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqgsnstqt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfqgsnstqt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqgsnstqt .gt_left {
  text-align: left;
}

#bfqgsnstqt .gt_center {
  text-align: center;
}

#bfqgsnstqt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bfqgsnstqt .gt_font_normal {
  font-weight: normal;
}

#bfqgsnstqt .gt_font_bold {
  font-weight: bold;
}

#bfqgsnstqt .gt_font_italic {
  font-style: italic;
}

#bfqgsnstqt .gt_super {
  font-size: 65%;
}

#bfqgsnstqt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bfqgsnstqt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bfqgsnstqt .gt_indent_1 {
  text-indent: 5px;
}

#bfqgsnstqt .gt_indent_2 {
  text-indent: 10px;
}

#bfqgsnstqt .gt_indent_3 {
  text-indent: 15px;
}

#bfqgsnstqt .gt_indent_4 {
  text-indent: 20px;
}

#bfqgsnstqt .gt_indent_5 {
  text-indent: 25px;
}

#bfqgsnstqt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bfqgsnstqt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border">Pitch Sequence for Batter 457705</th>
</tr>
<tr class="odd gt_col_headings">
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="first_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">first_pitch</th>
<th id="second_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">second_pitch</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="7" id="744875 - 4" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">744875 - 4</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_right" headers="744875 - 4  batter">457705</td>
<td class="gt_row gt_right" headers="744875 - 4  pitch_number">1</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_type">SL</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  first_pitch">NA</td>
<td class="gt_row gt_left" headers="744875 - 4  second_pitch">NA</td>
<td class="gt_row gt_left" headers="744875 - 4  third_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="744875 - 4  batter">457705</td>
<td class="gt_row gt_right" headers="744875 - 4  pitch_number">2</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_type">CU</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  first_pitch">NA</td>
<td class="gt_row gt_left" headers="744875 - 4  second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  third_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="744875 - 4  batter">457705</td>
<td class="gt_row gt_right" headers="744875 - 4  pitch_number">3</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_type">CH</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="744875 - 4  first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  third_pitch">Off-Speed</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="744875 - 4  batter">457705</td>
<td class="gt_row gt_right" headers="744875 - 4  pitch_number">4</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_type">FF</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="744875 - 4  first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="744875 - 4  third_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="744875 - 4  batter">457705</td>
<td class="gt_row gt_right" headers="744875 - 4  pitch_number">5</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_type">SL</td>
<td class="gt_row gt_left" headers="744875 - 4  pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="744875 - 4  first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="744875 - 4  second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="744875 - 4  third_pitch">Breaking Ball</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Looking at the table above, it is clear that our code is doing what we want once we have at least three pitches. However, for our analysis we only want three-pitch sequences, so we will need to remove the rows that have NAs in the first_pitch column.</p>
<p>Now that we understand the code, lets create a new dataset with all of our three-pitch sequences.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>TIP:</strong> You may notice we ran the function ungroup(). This is typically good practice as it can cause problems down the road if you don’t realize your code is still grouped. However, your output right now will not change if you remove this line of code.</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>three_pitch_seq <span class="ot">&lt;-</span> pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch  =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch  =</span> pitch_category</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(first_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_pk, at_bat_number, batter, pitch_number, pitch_type, pitch_category, first_pitch, second_pitch, third_pitch)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>three_pitch_seq <span class="sc">%&gt;%</span> </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Three Pitch Sequence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="czsygwrhpb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#czsygwrhpb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#czsygwrhpb thead, #czsygwrhpb tbody, #czsygwrhpb tfoot, #czsygwrhpb tr, #czsygwrhpb td, #czsygwrhpb th {
  border-style: none;
}

#czsygwrhpb p {
  margin: 0;
  padding: 0;
}

#czsygwrhpb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#czsygwrhpb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#czsygwrhpb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#czsygwrhpb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#czsygwrhpb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czsygwrhpb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsygwrhpb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czsygwrhpb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#czsygwrhpb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#czsygwrhpb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#czsygwrhpb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#czsygwrhpb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#czsygwrhpb .gt_spanner_row {
  border-bottom-style: hidden;
}

#czsygwrhpb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#czsygwrhpb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#czsygwrhpb .gt_from_md > :first-child {
  margin-top: 0;
}

#czsygwrhpb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#czsygwrhpb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#czsygwrhpb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#czsygwrhpb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#czsygwrhpb .gt_row_group_first td {
  border-top-width: 2px;
}

#czsygwrhpb .gt_row_group_first th {
  border-top-width: 2px;
}

#czsygwrhpb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsygwrhpb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#czsygwrhpb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#czsygwrhpb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsygwrhpb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsygwrhpb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#czsygwrhpb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#czsygwrhpb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#czsygwrhpb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsygwrhpb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czsygwrhpb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsygwrhpb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czsygwrhpb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsygwrhpb .gt_left {
  text-align: left;
}

#czsygwrhpb .gt_center {
  text-align: center;
}

#czsygwrhpb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#czsygwrhpb .gt_font_normal {
  font-weight: normal;
}

#czsygwrhpb .gt_font_bold {
  font-weight: bold;
}

#czsygwrhpb .gt_font_italic {
  font-style: italic;
}

#czsygwrhpb .gt_super {
  font-size: 65%;
}

#czsygwrhpb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#czsygwrhpb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#czsygwrhpb .gt_indent_1 {
  text-indent: 5px;
}

#czsygwrhpb .gt_indent_2 {
  text-indent: 10px;
}

#czsygwrhpb .gt_indent_3 {
  text-indent: 15px;
}

#czsygwrhpb .gt_indent_4 {
  text-indent: 20px;
}

#czsygwrhpb .gt_indent_5 {
  text-indent: 25px;
}

#czsygwrhpb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#czsygwrhpb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border">Three Pitch Sequence</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="first_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">first_pitch</th>
<th id="second_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">second_pitch</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">11</td>
<td class="gt_row gt_right" headers="batter">572191</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now we need to begin to construct our transition matrix. Our first step is to create a variable called “state”, which will bet the first two pitches a batter gets. We then need to determine the counts for each combination of state with third pitch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>state_counts <span class="ot">&lt;-</span> three_pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">paste</span>(first_pitch, second_pitch, <span class="at">sep =</span> <span class="st">"+"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state, third_pitch)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>state_counts <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Counts by Current State"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bxbwiaddjr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bxbwiaddjr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bxbwiaddjr thead, #bxbwiaddjr tbody, #bxbwiaddjr tfoot, #bxbwiaddjr tr, #bxbwiaddjr td, #bxbwiaddjr th {
  border-style: none;
}

#bxbwiaddjr p {
  margin: 0;
  padding: 0;
}

#bxbwiaddjr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bxbwiaddjr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bxbwiaddjr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bxbwiaddjr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bxbwiaddjr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxbwiaddjr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxbwiaddjr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxbwiaddjr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bxbwiaddjr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bxbwiaddjr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bxbwiaddjr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bxbwiaddjr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bxbwiaddjr .gt_spanner_row {
  border-bottom-style: hidden;
}

#bxbwiaddjr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bxbwiaddjr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bxbwiaddjr .gt_from_md > :first-child {
  margin-top: 0;
}

#bxbwiaddjr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bxbwiaddjr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bxbwiaddjr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bxbwiaddjr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bxbwiaddjr .gt_row_group_first td {
  border-top-width: 2px;
}

#bxbwiaddjr .gt_row_group_first th {
  border-top-width: 2px;
}

#bxbwiaddjr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxbwiaddjr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bxbwiaddjr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bxbwiaddjr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxbwiaddjr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxbwiaddjr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bxbwiaddjr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bxbwiaddjr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bxbwiaddjr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxbwiaddjr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxbwiaddjr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxbwiaddjr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxbwiaddjr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxbwiaddjr .gt_left {
  text-align: left;
}

#bxbwiaddjr .gt_center {
  text-align: center;
}

#bxbwiaddjr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bxbwiaddjr .gt_font_normal {
  font-weight: normal;
}

#bxbwiaddjr .gt_font_bold {
  font-weight: bold;
}

#bxbwiaddjr .gt_font_italic {
  font-style: italic;
}

#bxbwiaddjr .gt_super {
  font-size: 65%;
}

#bxbwiaddjr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bxbwiaddjr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bxbwiaddjr .gt_indent_1 {
  text-indent: 5px;
}

#bxbwiaddjr .gt_indent_2 {
  text-indent: 10px;
}

#bxbwiaddjr .gt_indent_3 {
  text-indent: 15px;
}

#bxbwiaddjr .gt_indent_4 {
  text-indent: 20px;
}

#bxbwiaddjr .gt_indent_5 {
  text-indent: 25px;
}

#bxbwiaddjr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bxbwiaddjr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Counts by Current State</th>
</tr>
<tr class="odd gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball+Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="n">17216</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball+Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="n">23144</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball+Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="n">3332</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball+Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="n">20444</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball+Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="n">28979</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now using these counts we need to create a contingency table. In order to do this we will use pivot_wider(). Inside pivot_wider(), “names_from = third_pitch” forces each unique third_pitch to now become a column. Then, “values_from = n” designates what goes inside each column, row combination. Lastly, “values_fill = 0” ensures that any missing combinations (e.g.&nbsp;a particular (state, third_pitch) that didn’t occur) get a zero instead of NA. Then, “column_to_rownames(”state”)“, moves the state column out of the body and into the row names of the data frame. Then,”as.matrix” changes this from a data_frame to a matrix. Lastly, “prop.table(margin = 1)”, creates proportions such that every row sums to 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>transition_matrix <span class="ot">&lt;-</span> state_counts <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from   =</span> third_pitch, <span class="at">values_from  =</span> n, <span class="at">values_fill  =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>transition_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            Breaking Ball  Fastball  Off-Speed
Breaking Ball+Breaking Ball     0.3940309 0.5297080 0.07626110
Breaking Ball+Fastball          0.3702818 0.5248678 0.10485039
Breaking Ball+Off-Speed         0.2429973 0.4829345 0.27406826
Fastball+Breaking Ball          0.4019251 0.5063947 0.09168013
Fastball+Fastball               0.2877884 0.5864531 0.12575851
Fastball+Off-Speed              0.1676412 0.5213053 0.31105353
Off-Speed+Breaking Ball         0.2665959 0.4788350 0.25456904
Off-Speed+Fastball              0.2168361 0.5054608 0.27770310
Off-Speed+Off-Speed             0.1767698 0.5554614 0.26776883</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 3">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>What if instead of three- pitch sequences we wanted four pitch sequences. How would the code we ran need to change?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 3 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The code below allows for four pitch sequences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>four_pitch_seq <span class="ot">&lt;-</span> pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch  =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">3</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch  =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fourth_pitch =</span> pitch_category</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(first_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_pk, at_bat_number, batter, pitch_number, pitch_type, pitch_category, first_pitch, second_pitch, third_pitch, fourth_pitch)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>four_pitch_seq <span class="sc">%&gt;%</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Four Pitch Sequence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="agpumafxrx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#agpumafxrx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#agpumafxrx thead, #agpumafxrx tbody, #agpumafxrx tfoot, #agpumafxrx tr, #agpumafxrx td, #agpumafxrx th {
  border-style: none;
}

#agpumafxrx p {
  margin: 0;
  padding: 0;
}

#agpumafxrx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#agpumafxrx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#agpumafxrx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#agpumafxrx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#agpumafxrx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agpumafxrx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agpumafxrx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agpumafxrx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#agpumafxrx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#agpumafxrx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#agpumafxrx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#agpumafxrx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#agpumafxrx .gt_spanner_row {
  border-bottom-style: hidden;
}

#agpumafxrx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#agpumafxrx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#agpumafxrx .gt_from_md > :first-child {
  margin-top: 0;
}

#agpumafxrx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#agpumafxrx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#agpumafxrx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#agpumafxrx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#agpumafxrx .gt_row_group_first td {
  border-top-width: 2px;
}

#agpumafxrx .gt_row_group_first th {
  border-top-width: 2px;
}

#agpumafxrx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agpumafxrx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#agpumafxrx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#agpumafxrx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agpumafxrx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#agpumafxrx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#agpumafxrx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#agpumafxrx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#agpumafxrx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agpumafxrx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agpumafxrx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agpumafxrx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agpumafxrx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#agpumafxrx .gt_left {
  text-align: left;
}

#agpumafxrx .gt_center {
  text-align: center;
}

#agpumafxrx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#agpumafxrx .gt_font_normal {
  font-weight: normal;
}

#agpumafxrx .gt_font_bold {
  font-weight: bold;
}

#agpumafxrx .gt_font_italic {
  font-style: italic;
}

#agpumafxrx .gt_super {
  font-size: 65%;
}

#agpumafxrx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#agpumafxrx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#agpumafxrx .gt_indent_1 {
  text-indent: 5px;
}

#agpumafxrx .gt_indent_2 {
  text-indent: 10px;
}

#agpumafxrx .gt_indent_3 {
  text-indent: 15px;
}

#agpumafxrx .gt_indent_4 {
  text-indent: 20px;
}

#agpumafxrx .gt_indent_5 {
  text-indent: 25px;
}

#agpumafxrx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#agpumafxrx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border">Four Pitch Sequence</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="first_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">first_pitch</th>
<th id="second_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">second_pitch</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="fourth_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">fourth_pitch</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">11</td>
<td class="gt_row gt_right" headers="batter">572191</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">13</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">15</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">16</td>
<td class="gt_row gt_right" headers="batter">660688</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">20</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then to get the transition matrix run the code below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>state_counts2 <span class="ot">&lt;-</span> four_pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">paste</span>(first_pitch, second_pitch, third_pitch, <span class="at">sep =</span> <span class="st">"+"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state, fourth_pitch)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>transition_matrix2 <span class="ot">&lt;-</span> state_counts2 <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from   =</span> fourth_pitch, <span class="at">values_from  =</span> n, <span class="at">values_fill  =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>transition_matrix2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          Breaking Ball  Fastball  Off-Speed
Breaking Ball+Breaking Ball+Breaking Ball     0.4378015 0.5134803 0.04871819
Breaking Ball+Breaking Ball+Fastball          0.4517414 0.4746220 0.07363661
Breaking Ball+Breaking Ball+Off-Speed         0.3349710 0.4662796 0.19874944
Breaking Ball+Fastball+Breaking Ball          0.4429975 0.4773862 0.07961634
Breaking Ball+Fastball+Fastball               0.3952141 0.5117752 0.09301067
Breaking Ball+Fastball+Off-Speed              0.2813978 0.4863374 0.23226484
Breaking Ball+Off-Speed+Breaking Ball         0.3023256 0.4934277 0.20424671
Breaking Ball+Off-Speed+Fastball              0.3054726 0.4587065 0.23582090
Breaking Ball+Off-Speed+Off-Speed             0.2705061 0.5261780 0.20331588
Fastball+Breaking Ball+Breaking Ball          0.3624684 0.5657702 0.07176142
Fastball+Breaking Ball+Fastball               0.3405492 0.5668355 0.09261530
Fastball+Breaking Ball+Off-Speed              0.2312304 0.5289752 0.23979446
Fastball+Fastball+Breaking Ball               0.3666179 0.5586972 0.07468482
Fastball+Fastball+Fastball                    0.2529704 0.6411483 0.10588128
Fastball+Fastball+Off-Speed                   0.1371494 0.5844116 0.27843908
Fastball+Off-Speed+Breaking Ball              0.2678227 0.5077071 0.22447013
Fastball+Off-Speed+Fastball                   0.2129542 0.5512375 0.23580832
Fastball+Off-Speed+Off-Speed                  0.1700390 0.5981541 0.23180689
Off-Speed+Breaking Ball+Breaking Ball         0.2708029 0.4722628 0.25693431
Off-Speed+Breaking Ball+Fastball              0.2840483 0.4369013 0.27905040
Off-Speed+Breaking Ball+Off-Speed             0.2579643 0.4988345 0.24320124
Off-Speed+Fastball+Breaking Ball              0.2614907 0.4661491 0.27236025
Off-Speed+Fastball+Fastball                   0.1979689 0.5056195 0.29641165
Off-Speed+Fastball+Off-Speed                  0.1637324 0.4979879 0.33827968
Off-Speed+Off-Speed+Breaking Ball             0.1949414 0.4904380 0.31462060
Off-Speed+Off-Speed+Fastball                  0.1839566 0.4702453 0.34579815
Off-Speed+Off-Speed+Off-Speed                 0.1181379 0.5274484 0.35441370</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="expectancy-matrix" class="level1 page-columns page-full">
<h1>Expectancy Matrix</h1>
<p>A transition matrix cannot tell you how successful a combination of pitches is, it can only tell you what we have seen as a likely next pitch given the first two. It is much more valuable that we understand the success of a pitch sequence. As we move through this section the main question we will be working to answer is:</p>
<ul>
<li>What third pitch is most successful given the first two.</li>
</ul>
<p>The main difference between an expectancy matrix and a transition matrix is that you’re taking averages of success rather than just transition counts.</p>
<p><span class="math display">\[M_{(i,j),k}=\Pr\bigl(\text{success on pitch}_3 = k \;\big|\; \text{pitch}_1 = i,\;\text{pitch}_2 = j\bigr)\]</span></p>
<p>Therefore, we want to <strong>assess which 3-pitch sequences show the most promise</strong>. We will do this by <strong>separating consecutive 3-pitch sequences in the data that occurred on the same at bat</strong>. Just as before, this means that a 4-pitch at-bat would create two sets of three, the first three pitches as one “triplet” and the last three pitches as a second “triplet”. After creating these triplets, we will ultimately assess how the first two pitch types influence the <strong>effectiveness</strong> of the third pitch type. For example, maybe two fastballs in a row decrease the effectiveness of a fastball on the third pitch, but a different pair might set up the third-pitch fastball to be more successful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>three_pitch_seq_suc <span class="ot">&lt;-</span> pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch =</span> pitch_category,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">success_3 =</span> success</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(first_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_pk, at_bat_number, batter, pitch_number, pitch_type, pitch_category, first_pitch, second_pitch, third_pitch, success_3, description, events)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>three_pitch_seq_suc <span class="sc">%&gt;%</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Three Pitch Sequence Successes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="czsxmjkwij" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#czsxmjkwij table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#czsxmjkwij thead, #czsxmjkwij tbody, #czsxmjkwij tfoot, #czsxmjkwij tr, #czsxmjkwij td, #czsxmjkwij th {
  border-style: none;
}

#czsxmjkwij p {
  margin: 0;
  padding: 0;
}

#czsxmjkwij .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#czsxmjkwij .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#czsxmjkwij .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#czsxmjkwij .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#czsxmjkwij .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czsxmjkwij .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsxmjkwij .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czsxmjkwij .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#czsxmjkwij .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#czsxmjkwij .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#czsxmjkwij .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#czsxmjkwij .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#czsxmjkwij .gt_spanner_row {
  border-bottom-style: hidden;
}

#czsxmjkwij .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#czsxmjkwij .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#czsxmjkwij .gt_from_md > :first-child {
  margin-top: 0;
}

#czsxmjkwij .gt_from_md > :last-child {
  margin-bottom: 0;
}

#czsxmjkwij .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#czsxmjkwij .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#czsxmjkwij .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#czsxmjkwij .gt_row_group_first td {
  border-top-width: 2px;
}

#czsxmjkwij .gt_row_group_first th {
  border-top-width: 2px;
}

#czsxmjkwij .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsxmjkwij .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#czsxmjkwij .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#czsxmjkwij .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsxmjkwij .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsxmjkwij .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#czsxmjkwij .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#czsxmjkwij .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#czsxmjkwij .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czsxmjkwij .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czsxmjkwij .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsxmjkwij .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czsxmjkwij .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czsxmjkwij .gt_left {
  text-align: left;
}

#czsxmjkwij .gt_center {
  text-align: center;
}

#czsxmjkwij .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#czsxmjkwij .gt_font_normal {
  font-weight: normal;
}

#czsxmjkwij .gt_font_bold {
  font-weight: bold;
}

#czsxmjkwij .gt_font_italic {
  font-style: italic;
}

#czsxmjkwij .gt_super {
  font-size: 65%;
}

#czsxmjkwij .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#czsxmjkwij .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#czsxmjkwij .gt_indent_1 {
  text-indent: 5px;
}

#czsxmjkwij .gt_indent_2 {
  text-indent: 10px;
}

#czsxmjkwij .gt_indent_3 {
  text-indent: 15px;
}

#czsxmjkwij .gt_indent_4 {
  text-indent: 20px;
}

#czsxmjkwij .gt_indent_5 {
  text-indent: 25px;
}

#czsxmjkwij .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#czsxmjkwij div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="12" class="gt_heading gt_title gt_font_normal gt_bottom_border">Three Pitch Sequence Successes</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="first_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">first_pitch</th>
<th id="second_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">second_pitch</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="success_3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_3</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
<th id="events" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">events</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">walk</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">double</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">called_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_3">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">single</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">11</td>
<td class="gt_row gt_right" headers="batter">572191</td>
<td class="gt_row gt_right" headers="pitch_number">3</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_3">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Consideration:</strong> You may notice that our 4th row was considered not a success because the ball was hit into play. However, the result of the play was a field out. This is a point of possible further research.</p>
</div></div><p>Now it is time to <strong>build the expectancy matrix</strong>, we will do so by first combining all two-pitch pairs with the third pitch using the group_by() function. Then we create a new variable, success rate, using the summarise() function, which allows us to get the proportion of success (.groups = “drop” works the same way as ungroup()).Lastly, we need to create our state variable like we did for the transition matrix and use pivot_wider to get the variables of interest displayed appropriately.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>expectancy_matrix <span class="ot">&lt;-</span> three_pitch_seq_suc <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(first_pitch, second_pitch, third_pitch) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">success_rate =</span> <span class="fu">mean</span>(success_3), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">paste</span>(first_pitch, <span class="st">"+"</span>, second_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, third_pitch, success_rate) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> third_pitch, <span class="at">values_from =</span> success_rate, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>expectancy_matrix <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Three Pitch Sequence Expectancy Matrix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="kycawsueco" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kycawsueco table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kycawsueco thead, #kycawsueco tbody, #kycawsueco tfoot, #kycawsueco tr, #kycawsueco td, #kycawsueco th {
  border-style: none;
}

#kycawsueco p {
  margin: 0;
  padding: 0;
}

#kycawsueco .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kycawsueco .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kycawsueco .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kycawsueco .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kycawsueco .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kycawsueco .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kycawsueco .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kycawsueco .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kycawsueco .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kycawsueco .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kycawsueco .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kycawsueco .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kycawsueco .gt_spanner_row {
  border-bottom-style: hidden;
}

#kycawsueco .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kycawsueco .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kycawsueco .gt_from_md > :first-child {
  margin-top: 0;
}

#kycawsueco .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kycawsueco .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kycawsueco .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kycawsueco .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kycawsueco .gt_row_group_first td {
  border-top-width: 2px;
}

#kycawsueco .gt_row_group_first th {
  border-top-width: 2px;
}

#kycawsueco .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kycawsueco .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kycawsueco .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kycawsueco .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kycawsueco .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kycawsueco .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kycawsueco .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kycawsueco .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kycawsueco .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kycawsueco .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kycawsueco .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kycawsueco .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kycawsueco .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kycawsueco .gt_left {
  text-align: left;
}

#kycawsueco .gt_center {
  text-align: center;
}

#kycawsueco .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kycawsueco .gt_font_normal {
  font-weight: normal;
}

#kycawsueco .gt_font_bold {
  font-weight: bold;
}

#kycawsueco .gt_font_italic {
  font-style: italic;
}

#kycawsueco .gt_super {
  font-size: 65%;
}

#kycawsueco .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kycawsueco .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kycawsueco .gt_indent_1 {
  text-indent: 5px;
}

#kycawsueco .gt_indent_2 {
  text-indent: 10px;
}

#kycawsueco .gt_indent_3 {
  text-indent: 15px;
}

#kycawsueco .gt_indent_4 {
  text-indent: 20px;
}

#kycawsueco .gt_indent_5 {
  text-indent: 25px;
}

#kycawsueco .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kycawsueco div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Three Pitch Sequence Expectancy Matrix</th>
</tr>
<tr class="odd gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="Breaking-Ball" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Breaking Ball</th>
<th id="Fastball" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Fastball</th>
<th id="Off-Speed" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Off-Speed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4466194</td>
<td class="gt_row gt_right" headers="Fastball">0.4557121</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4111645</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4202700</td>
<td class="gt_row gt_right" headers="Fastball">0.4886297</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3878045</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4565709</td>
<td class="gt_row gt_right" headers="Fastball">0.4524777</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4159748</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4471613</td>
<td class="gt_row gt_right" headers="Fastball">0.4648744</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3992291</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Fastball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4248615</td>
<td class="gt_row gt_right" headers="Fastball">0.4855097</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3772235</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4477861</td>
<td class="gt_row gt_right" headers="Fastball">0.4667204</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4218820</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4688191</td>
<td class="gt_row gt_right" headers="Fastball">0.4501354</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4201019</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Off-Speed + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4411081</td>
<td class="gt_row gt_right" headers="Fastball">0.4792654</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3961579</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4688249</td>
<td class="gt_row gt_right" headers="Fastball">0.4390740</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4179420</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Question: Interpret the expectancy matrix**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Question: Interpret the expectancy matrix</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does the value in the first row and first column mean?</p>
<p>What’s the probability of success of a fastball thrown after two other fastballs?</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Answer:**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Answer:</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This value represents the proportion of successful breaking balls thrown after two consecutive breaking balls previously.</p>
<p>The probability of success of a fastball thrown after two fastballs is approximately 48.6%.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 4">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>What if instead of three- pitch sequences we wanted four pitch sequences. How would the code we ran need to change?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 4 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The code below allows for four pitch sequences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>four_pitch_seq_suc <span class="ot">&lt;-</span> pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch  =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">3</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch  =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fourth_pitch =</span> pitch_category,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">success_4 =</span> success</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(first_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_pk, at_bat_number, batter, pitch_number, pitch_type, pitch_category, first_pitch, second_pitch, third_pitch, fourth_pitch, success_4, description, events)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>four_pitch_seq_suc <span class="sc">%&gt;%</span> </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Four Pitch Sequence Successes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="mbtdyzqchh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mbtdyzqchh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mbtdyzqchh thead, #mbtdyzqchh tbody, #mbtdyzqchh tfoot, #mbtdyzqchh tr, #mbtdyzqchh td, #mbtdyzqchh th {
  border-style: none;
}

#mbtdyzqchh p {
  margin: 0;
  padding: 0;
}

#mbtdyzqchh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mbtdyzqchh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mbtdyzqchh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mbtdyzqchh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mbtdyzqchh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbtdyzqchh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbtdyzqchh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbtdyzqchh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mbtdyzqchh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mbtdyzqchh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mbtdyzqchh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mbtdyzqchh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mbtdyzqchh .gt_spanner_row {
  border-bottom-style: hidden;
}

#mbtdyzqchh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mbtdyzqchh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mbtdyzqchh .gt_from_md > :first-child {
  margin-top: 0;
}

#mbtdyzqchh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mbtdyzqchh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mbtdyzqchh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mbtdyzqchh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mbtdyzqchh .gt_row_group_first td {
  border-top-width: 2px;
}

#mbtdyzqchh .gt_row_group_first th {
  border-top-width: 2px;
}

#mbtdyzqchh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbtdyzqchh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mbtdyzqchh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mbtdyzqchh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbtdyzqchh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbtdyzqchh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mbtdyzqchh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mbtdyzqchh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mbtdyzqchh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbtdyzqchh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbtdyzqchh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbtdyzqchh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbtdyzqchh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbtdyzqchh .gt_left {
  text-align: left;
}

#mbtdyzqchh .gt_center {
  text-align: center;
}

#mbtdyzqchh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mbtdyzqchh .gt_font_normal {
  font-weight: normal;
}

#mbtdyzqchh .gt_font_bold {
  font-weight: bold;
}

#mbtdyzqchh .gt_font_italic {
  font-style: italic;
}

#mbtdyzqchh .gt_super {
  font-size: 65%;
}

#mbtdyzqchh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mbtdyzqchh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mbtdyzqchh .gt_indent_1 {
  text-indent: 5px;
}

#mbtdyzqchh .gt_indent_2 {
  text-indent: 10px;
}

#mbtdyzqchh .gt_indent_3 {
  text-indent: 15px;
}

#mbtdyzqchh .gt_indent_4 {
  text-indent: 20px;
}

#mbtdyzqchh .gt_indent_5 {
  text-indent: 25px;
}

#mbtdyzqchh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mbtdyzqchh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="13" class="gt_heading gt_title gt_font_normal gt_bottom_border">Four Pitch Sequence Successes</th>
</tr>
<tr class="odd gt_col_headings">
<th id="game_pk" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">game_pk</th>
<th id="at_bat_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">at_bat_number</th>
<th id="batter" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">batter</th>
<th id="pitch_number" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pitch_number</th>
<th id="pitch_type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_type</th>
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="first_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">first_pitch</th>
<th id="second_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">second_pitch</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="fourth_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">fourth_pitch</th>
<th id="success_4" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_4</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
<th id="events" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">events</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">1</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">3</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">walk</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">4</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">5</td>
<td class="gt_row gt_right" headers="batter">658668</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">1</td>
<td class="gt_row gt_left" headers="description">swinging_strike</td>
<td class="gt_row gt_left" headers="events">strikeout</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">7</td>
<td class="gt_row gt_right" headers="batter">657041</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">9</td>
<td class="gt_row gt_right" headers="batter">680779</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FF</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">double</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">10</td>
<td class="gt_row gt_right" headers="batter">665833</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">single</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">11</td>
<td class="gt_row gt_right" headers="batter">572191</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SL</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">sac_fly</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">13</td>
<td class="gt_row gt_right" headers="batter">656582</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_by_pitch</td>
<td class="gt_row gt_left" headers="events">hit_by_pitch</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">15</td>
<td class="gt_row gt_right" headers="batter">663647</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">16</td>
<td class="gt_row gt_right" headers="batter">660688</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">field_out</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">FC</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">5</td>
<td class="gt_row gt_left" headers="pitch_type">SI</td>
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_4">1</td>
<td class="gt_row gt_left" headers="description">foul</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">18</td>
<td class="gt_row gt_right" headers="batter">702358</td>
<td class="gt_row gt_right" headers="pitch_number">6</td>
<td class="gt_row gt_left" headers="pitch_type">CH</td>
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_left" headers="first_pitch">Fastball</td>
<td class="gt_row gt_left" headers="second_pitch">Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">hit_into_play</td>
<td class="gt_row gt_left" headers="events">single</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="game_pk">744875</td>
<td class="gt_row gt_right" headers="at_bat_number">20</td>
<td class="gt_row gt_right" headers="batter">457705</td>
<td class="gt_row gt_right" headers="pitch_number">4</td>
<td class="gt_row gt_left" headers="pitch_type">CU</td>
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_left" headers="first_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="second_pitch">Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_left" headers="fourth_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_4">0</td>
<td class="gt_row gt_left" headers="description">ball</td>
<td class="gt_row gt_left" headers="events">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then to get the expectancy matrix run the code below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>expectancy_matrix2 <span class="ot">&lt;-</span> four_pitch_seq_suc <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(first_pitch, second_pitch, third_pitch, fourth_pitch) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">success_rate =</span> <span class="fu">mean</span>(success_4), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">paste</span>(first_pitch, <span class="st">"+"</span>, second_pitch, <span class="st">"+"</span>, third_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, fourth_pitch, success_rate) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fourth_pitch, <span class="at">values_from =</span> success_rate, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>expectancy_matrix2 <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Four Pitch Sequence Expectancy Matrix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="spuhoubgle" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#spuhoubgle table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#spuhoubgle thead, #spuhoubgle tbody, #spuhoubgle tfoot, #spuhoubgle tr, #spuhoubgle td, #spuhoubgle th {
  border-style: none;
}

#spuhoubgle p {
  margin: 0;
  padding: 0;
}

#spuhoubgle .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#spuhoubgle .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#spuhoubgle .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#spuhoubgle .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#spuhoubgle .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#spuhoubgle .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#spuhoubgle .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#spuhoubgle .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#spuhoubgle .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#spuhoubgle .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#spuhoubgle .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#spuhoubgle .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#spuhoubgle .gt_spanner_row {
  border-bottom-style: hidden;
}

#spuhoubgle .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#spuhoubgle .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#spuhoubgle .gt_from_md > :first-child {
  margin-top: 0;
}

#spuhoubgle .gt_from_md > :last-child {
  margin-bottom: 0;
}

#spuhoubgle .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#spuhoubgle .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#spuhoubgle .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#spuhoubgle .gt_row_group_first td {
  border-top-width: 2px;
}

#spuhoubgle .gt_row_group_first th {
  border-top-width: 2px;
}

#spuhoubgle .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#spuhoubgle .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#spuhoubgle .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#spuhoubgle .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#spuhoubgle .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#spuhoubgle .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#spuhoubgle .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#spuhoubgle .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#spuhoubgle .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#spuhoubgle .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#spuhoubgle .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#spuhoubgle .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#spuhoubgle .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#spuhoubgle .gt_left {
  text-align: left;
}

#spuhoubgle .gt_center {
  text-align: center;
}

#spuhoubgle .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#spuhoubgle .gt_font_normal {
  font-weight: normal;
}

#spuhoubgle .gt_font_bold {
  font-weight: bold;
}

#spuhoubgle .gt_font_italic {
  font-style: italic;
}

#spuhoubgle .gt_super {
  font-size: 65%;
}

#spuhoubgle .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#spuhoubgle .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#spuhoubgle .gt_indent_1 {
  text-indent: 5px;
}

#spuhoubgle .gt_indent_2 {
  text-indent: 10px;
}

#spuhoubgle .gt_indent_3 {
  text-indent: 15px;
}

#spuhoubgle .gt_indent_4 {
  text-indent: 20px;
}

#spuhoubgle .gt_indent_5 {
  text-indent: 25px;
}

#spuhoubgle .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#spuhoubgle div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border">Four Pitch Sequence Expectancy Matrix</th>
</tr>
<tr class="odd gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="Breaking-Ball" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Breaking Ball</th>
<th id="Fastball" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Fastball</th>
<th id="Off-Speed" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Off-Speed</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4563526</td>
<td class="gt_row gt_right" headers="Fastball">0.4443626</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4019417</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4294039</td>
<td class="gt_row gt_right" headers="Fastball">0.5028441</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4014665</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4560000</td>
<td class="gt_row gt_right" headers="Fastball">0.4741379</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3797753</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4569618</td>
<td class="gt_row gt_right" headers="Fastball">0.4776217</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4045054</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4346575</td>
<td class="gt_row gt_right" headers="Fastball">0.4922247</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3707800</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4537815</td>
<td class="gt_row gt_right" headers="Fastball">0.4619125</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4276018</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4983278</td>
<td class="gt_row gt_right" headers="Fastball">0.4528689</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4430693</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4576547</td>
<td class="gt_row gt_right" headers="Fastball">0.5005423</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4145570</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4838710</td>
<td class="gt_row gt_right" headers="Fastball">0.4187396</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4098712</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4560147</td>
<td class="gt_row gt_right" headers="Fastball">0.4531121</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3933210</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Fastball + Breaking Ball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4145921</td>
<td class="gt_row gt_right" headers="Fastball">0.4871602</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3886010</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Breaking Ball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4456790</td>
<td class="gt_row gt_right" headers="Fastball">0.4522396</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4261905</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Fastball + Fastball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4504112</td>
<td class="gt_row gt_right" headers="Fastball">0.4655384</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4189602</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Fastball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4247964</td>
<td class="gt_row gt_right" headers="Fastball">0.4927516</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3779459</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Fastball + Fastball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4377358</td>
<td class="gt_row gt_right" headers="Fastball">0.4677648</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4412639</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Off-Speed + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4496403</td>
<td class="gt_row gt_right" headers="Fastball">0.4427577</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4206009</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Fastball + Off-Speed + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4401583</td>
<td class="gt_row gt_right" headers="Fastball">0.4791746</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4104511</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Off-Speed + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4634656</td>
<td class="gt_row gt_right" headers="Fastball">0.4394659</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4441041</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.5094340</td>
<td class="gt_row gt_right" headers="Fastball">0.4853168</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4090909</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Off-Speed + Breaking Ball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4516129</td>
<td class="gt_row gt_right" headers="Fastball">0.4652050</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4149254</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Breaking Ball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4789157</td>
<td class="gt_row gt_right" headers="Fastball">0.4345794</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4536741</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Off-Speed + Fastball + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4821853</td>
<td class="gt_row gt_right" headers="Fastball">0.4556962</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4047891</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Fastball + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4705882</td>
<td class="gt_row gt_right" headers="Fastball">0.4951794</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3841937</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Off-Speed + Fastball + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4685100</td>
<td class="gt_row gt_right" headers="Fastball">0.4737374</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4356877</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Off-Speed + Breaking Ball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4905063</td>
<td class="gt_row gt_right" headers="Fastball">0.4377358</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4137255</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Off-Speed + Off-Speed + Fastball</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4251366</td>
<td class="gt_row gt_right" headers="Fastball">0.4801197</td>
<td class="gt_row gt_right" headers="Off-Speed">0.3796512</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Off-Speed + Off-Speed + Off-Speed</td>
<td class="gt_row gt_right" headers="Breaking Ball">0.4460967</td>
<td class="gt_row gt_right" headers="Fastball">0.4529559</td>
<td class="gt_row gt_right" headers="Off-Speed">0.4151177</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
<p>While pitchers likely care most about the probability of success, it is useful in answering our research question of whether pitch sequencing matters to investigate the multiplying effect sequences have on success. This will include assessing the success probability of each pitch category overall, and then seeing if any of the cells in our previous expectancy matrix deviate significantly from their overall success value.</p>
<p>To comment on an increase in effectiveness for the third pitch type, we need to <strong>calculate each pitch category’s effectiveness overall</strong> in the data (we will call this baseline_success):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>category_success <span class="ot">&lt;-</span> pitches_clean <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pitch_category) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_pitches =</span> <span class="fu">n</span>(), <span class="at">baseline_success =</span> <span class="fu">mean</span>(success)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(baseline_success))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>category_success <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Success Rate by Pitch Category"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="qwtdeqznpg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qwtdeqznpg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qwtdeqznpg thead, #qwtdeqznpg tbody, #qwtdeqznpg tfoot, #qwtdeqznpg tr, #qwtdeqznpg td, #qwtdeqznpg th {
  border-style: none;
}

#qwtdeqznpg p {
  margin: 0;
  padding: 0;
}

#qwtdeqznpg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qwtdeqznpg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qwtdeqznpg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qwtdeqznpg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qwtdeqznpg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qwtdeqznpg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwtdeqznpg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qwtdeqznpg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qwtdeqznpg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qwtdeqznpg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qwtdeqznpg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qwtdeqznpg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qwtdeqznpg .gt_spanner_row {
  border-bottom-style: hidden;
}

#qwtdeqznpg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qwtdeqznpg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qwtdeqznpg .gt_from_md > :first-child {
  margin-top: 0;
}

#qwtdeqznpg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qwtdeqznpg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qwtdeqznpg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qwtdeqznpg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qwtdeqznpg .gt_row_group_first td {
  border-top-width: 2px;
}

#qwtdeqznpg .gt_row_group_first th {
  border-top-width: 2px;
}

#qwtdeqznpg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwtdeqznpg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qwtdeqznpg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qwtdeqznpg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwtdeqznpg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwtdeqznpg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qwtdeqznpg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qwtdeqznpg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qwtdeqznpg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qwtdeqznpg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qwtdeqznpg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwtdeqznpg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qwtdeqznpg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qwtdeqznpg .gt_left {
  text-align: left;
}

#qwtdeqznpg .gt_center {
  text-align: center;
}

#qwtdeqznpg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qwtdeqznpg .gt_font_normal {
  font-weight: normal;
}

#qwtdeqznpg .gt_font_bold {
  font-weight: bold;
}

#qwtdeqznpg .gt_font_italic {
  font-style: italic;
}

#qwtdeqznpg .gt_super {
  font-size: 65%;
}

#qwtdeqznpg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qwtdeqznpg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qwtdeqznpg .gt_indent_1 {
  text-indent: 5px;
}

#qwtdeqznpg .gt_indent_2 {
  text-indent: 10px;
}

#qwtdeqznpg .gt_indent_3 {
  text-indent: 15px;
}

#qwtdeqznpg .gt_indent_4 {
  text-indent: 20px;
}

#qwtdeqznpg .gt_indent_5 {
  text-indent: 25px;
}

#qwtdeqznpg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qwtdeqznpg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Success Rate by Pitch Category</th>
</tr>
<tr class="odd gt_col_headings">
<th id="pitch_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">pitch_category</th>
<th id="total_pitches" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_pitches</th>
<th id="baseline_success" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">baseline_success</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_category">Fastball</td>
<td class="gt_row gt_right" headers="total_pitches">393489</td>
<td class="gt_row gt_right" headers="baseline_success">0.4849157</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="pitch_category">Breaking Ball</td>
<td class="gt_row gt_right" headers="total_pitches">215751</td>
<td class="gt_row gt_right" headers="baseline_success">0.4615784</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="pitch_category">Off-Speed</td>
<td class="gt_row gt_right" headers="total_pitches">94700</td>
<td class="gt_row gt_right" headers="baseline_success">0.4081098</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Question:**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Question:</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Are some pitches more successful than others overall?</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Answer:**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Answer:</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It appears that the fastball is most effective at about 48.5%, followed by the breaking ball at 46.2% and off-speed at 40.8%, respectively.</p>
</div>
</div>
</div>
<p>Now we will investigate if these success probabilities change significantly based on the previous two pitches thrown. While we investiagate this we will also learn how to make visualizations.</p>
</section>
<section id="creating-a-heat-map" class="level1">
<h1>Creating a Heat Map</h1>
<p>As we work through this next section, consider:</p>
<ul>
<li>What is a heat map?</li>
<li>What do you think a heat map displays?</li>
</ul>
<p>Now that we have our expectancy matrix, let’s show it off using a heat map! First, we will reorient the data for ease of use. (We are essentially undoing pivot_wider by using pivot_longer)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Reshape to long format</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>long_matrix <span class="ot">&lt;-</span> expectancy_matrix <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>state, <span class="at">names_to =</span> <span class="st">"third_pitch"</span>, <span class="at">values_to =</span> <span class="st">"success_rate"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>long_matrix <span class="sc">%&gt;%</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Three Pitch Sequence Successes"</span>, <span class="st">"Using pivot_longer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="sounmqylbx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sounmqylbx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sounmqylbx thead, #sounmqylbx tbody, #sounmqylbx tfoot, #sounmqylbx tr, #sounmqylbx td, #sounmqylbx th {
  border-style: none;
}

#sounmqylbx p {
  margin: 0;
  padding: 0;
}

#sounmqylbx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sounmqylbx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sounmqylbx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sounmqylbx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sounmqylbx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sounmqylbx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sounmqylbx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sounmqylbx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sounmqylbx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sounmqylbx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sounmqylbx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sounmqylbx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sounmqylbx .gt_spanner_row {
  border-bottom-style: hidden;
}

#sounmqylbx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sounmqylbx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sounmqylbx .gt_from_md > :first-child {
  margin-top: 0;
}

#sounmqylbx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sounmqylbx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sounmqylbx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sounmqylbx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sounmqylbx .gt_row_group_first td {
  border-top-width: 2px;
}

#sounmqylbx .gt_row_group_first th {
  border-top-width: 2px;
}

#sounmqylbx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sounmqylbx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sounmqylbx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sounmqylbx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sounmqylbx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sounmqylbx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sounmqylbx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sounmqylbx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sounmqylbx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sounmqylbx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sounmqylbx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sounmqylbx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sounmqylbx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sounmqylbx .gt_left {
  text-align: left;
}

#sounmqylbx .gt_center {
  text-align: center;
}

#sounmqylbx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sounmqylbx .gt_font_normal {
  font-weight: normal;
}

#sounmqylbx .gt_font_bold {
  font-weight: bold;
}

#sounmqylbx .gt_font_italic {
  font-style: italic;
}

#sounmqylbx .gt_super {
  font-size: 65%;
}

#sounmqylbx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sounmqylbx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sounmqylbx .gt_indent_1 {
  text-indent: 5px;
}

#sounmqylbx .gt_indent_2 {
  text-indent: 10px;
}

#sounmqylbx .gt_indent_3 {
  text-indent: 15px;
}

#sounmqylbx .gt_indent_4 {
  text-indent: 20px;
}

#sounmqylbx .gt_indent_5 {
  text-indent: 25px;
}

#sounmqylbx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sounmqylbx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Three Pitch Sequence Successes</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Using pivot_longer</th>
</tr>
<tr class="header gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="success_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_rate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4466194</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_rate">0.4557121</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_rate">0.4111645</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4202700</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_rate">0.4886297</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_rate">0.3878045</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4565709</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_rate">0.4524777</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Off-Speed</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_rate">0.4159748</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Fastball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4471613</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We are going to create a new variable we have dubbed “success_lift” by measuring how much the two pitch sequences “lift” the probability of success. To determine this lifting effect, we will divide the new success rate by the overall success rate for the given third pitch category. Thus, a value above 1 would mean it improves success likelihood, and a value below 1 means it decreases success likelihood. This will help us evaluate what 2-pitch sequences have the greatest effect on possibly “tricking” the batter at the third pitch.</p>
<p>In order to have all of the information we want in one dataframe, we need to combine our category_success dataframe to our long_matrix. The function left_join() allows us to combine dataframes as long as one column is the same in both. For us our column “third_pitch” in the long_matrix is the same as “pitch_category” in the category_success dataframe. Within left_join we are also able to select only the columns pitch_category and baseline_success from category_success. Lastly, using mutate() we are able to create our new variable of interest success_lift.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>long_matrix_lift <span class="ot">&lt;-</span> long_matrix <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(category_success <span class="sc">%&gt;%</span> <span class="fu">select</span>(pitch_category, baseline_success),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"third_pitch"</span> <span class="ot">=</span> <span class="st">"pitch_category"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">success_lift =</span> success_rate <span class="sc">/</span> baseline_success)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>long_matrix_lift <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="st">"Three Pitch Sequence Successes Lift"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="pzywuczelg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pzywuczelg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pzywuczelg thead, #pzywuczelg tbody, #pzywuczelg tfoot, #pzywuczelg tr, #pzywuczelg td, #pzywuczelg th {
  border-style: none;
}

#pzywuczelg p {
  margin: 0;
  padding: 0;
}

#pzywuczelg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pzywuczelg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pzywuczelg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pzywuczelg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pzywuczelg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzywuczelg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzywuczelg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzywuczelg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pzywuczelg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pzywuczelg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pzywuczelg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pzywuczelg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pzywuczelg .gt_spanner_row {
  border-bottom-style: hidden;
}

#pzywuczelg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pzywuczelg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pzywuczelg .gt_from_md > :first-child {
  margin-top: 0;
}

#pzywuczelg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pzywuczelg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pzywuczelg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pzywuczelg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pzywuczelg .gt_row_group_first td {
  border-top-width: 2px;
}

#pzywuczelg .gt_row_group_first th {
  border-top-width: 2px;
}

#pzywuczelg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzywuczelg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pzywuczelg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pzywuczelg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzywuczelg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzywuczelg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pzywuczelg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pzywuczelg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pzywuczelg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzywuczelg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzywuczelg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzywuczelg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzywuczelg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzywuczelg .gt_left {
  text-align: left;
}

#pzywuczelg .gt_center {
  text-align: center;
}

#pzywuczelg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pzywuczelg .gt_font_normal {
  font-weight: normal;
}

#pzywuczelg .gt_font_bold {
  font-weight: bold;
}

#pzywuczelg .gt_font_italic {
  font-style: italic;
}

#pzywuczelg .gt_super {
  font-size: 65%;
}

#pzywuczelg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pzywuczelg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pzywuczelg .gt_indent_1 {
  text-indent: 5px;
}

#pzywuczelg .gt_indent_2 {
  text-indent: 10px;
}

#pzywuczelg .gt_indent_3 {
  text-indent: 15px;
}

#pzywuczelg .gt_indent_4 {
  text-indent: 20px;
}

#pzywuczelg .gt_indent_5 {
  text-indent: 25px;
}

#pzywuczelg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pzywuczelg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Three Pitch Sequence Successes Lift</th>
</tr>
<tr class="odd gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="third_pitch" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">third_pitch</th>
<th id="success_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_rate</th>
<th id="baseline_success" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">baseline_success</th>
<th id="success_lift" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">success_lift</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4466194</td>
<td class="gt_row gt_right" headers="baseline_success">0.4615784</td>
<td class="gt_row gt_right" headers="success_lift">0.9675917</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_rate">0.4557121</td>
<td class="gt_row gt_right" headers="baseline_success">0.4849157</td>
<td class="gt_row gt_right" headers="success_lift">0.9397758</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Breaking Ball</td>
<td class="gt_row gt_left" headers="third_pitch">Off-Speed</td>
<td class="gt_row gt_right" headers="success_rate">0.4111645</td>
<td class="gt_row gt_right" headers="baseline_success">0.4081098</td>
<td class="gt_row gt_right" headers="success_lift">1.0074849</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Breaking Ball</td>
<td class="gt_row gt_right" headers="success_rate">0.4202700</td>
<td class="gt_row gt_right" headers="baseline_success">0.4615784</td>
<td class="gt_row gt_right" headers="success_lift">0.9105062</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="state">Breaking Ball + Fastball</td>
<td class="gt_row gt_left" headers="third_pitch">Fastball</td>
<td class="gt_row gt_right" headers="success_rate">0.4886297</td>
<td class="gt_row gt_right" headers="baseline_success">0.4849157</td>
<td class="gt_row gt_right" headers="success_lift">1.0076590</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now rather than displaying this information in a table, lets create a heat map!</p>
<p>In order to create a heat map, we begin by using ggplot(). Inside ggplot() we first list the dataframe we are using, then within aes() we provide the variable on the x, y, and color/fill. To get a heatmap specifically, we need to use geom_tile(). Inside geom_tile(), “color =”white” is putting a white border around each tile. Then, scale_fill_gradient2() is creating a legend for the fill variable. Within scale_fill_gradient2() we are designating red for low values observed for success_lift, white for middle values which we designate as 1, and high values of blue. Lastly, name allows us to change the title above the legend. The labs() function allows you to change the x and y axis lables as well as the overall title. Theme_minimal is a common thematic choice that many in the R community choose to make, but there are many ggplot() themes a user can choose to use. Lastly, theme() is used to add a 45 degree angle to the x-variable labels. Again this is a thematic choice and not necessary or desired by every user.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_matrix_lift, <span class="fu">aes</span>(<span class="at">x =</span> third_pitch, <span class="at">y =</span> state, <span class="at">fill =</span> success_lift)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">"Success Lift"</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Third Pitch (Category)"</span>, <span class="at">y =</span> <span class="st">"First + Second Pitch (Sequence)"</span>, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relative Effectiveness of 3-Pitch Sequences"</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The heat map above shows us that the greatest lifting effect comes through an Breaking Ball + Off-Speed paired with a Breaking Ball for the third pitch, roughly increasing success probability by 40%. The worst lifting effect was seen in the Breaking Ball + Breaking Ball paired with an Off-Speed for the third pitch, which decreases success probability by about 20%.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Discussion Questions**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Discussion Questions</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Interpret the heat map. What pitch sequences appear to have little effect on the success of the third pitch?</p></li>
<li><p>What would cause some pitch sequence success probabilities to be so high? What factors in baseball terms? What about viewing this from a statistical lens?</p></li>
<li><p>How might our imbalanced pitch counts effect the strength of our findings?</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 5">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Change the code from above in the following ways: - Change the border color to black. - Switch the legend such that blue is low and red is high - Remove the last two theme elements.</p>
<p>Consider if you like or dislike the changes.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 5 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 5 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_matrix_lift, <span class="fu">aes</span>(<span class="at">x =</span> third_pitch, <span class="at">y =</span> state, <span class="at">fill =</span> success_lift)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">"Success Lift"</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Third Pitch (Category)"</span>, <span class="at">y =</span> <span class="st">"First + Second Pitch (Sequence)"</span>, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relative Effectiveness of 3-Pitch Sequences"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>We have an initial glimpse into the lifting effects of each 3-pitch sequence, but pitchers are likely more concerned with what will give them the greatest probability of success, not the greatest lifting effect. We will create a very similar heat map but rather than the lifting effect, we will provide the <strong>raw success probability</strong> on the third pitch for a particular 3-pitch sequence.</p>
<p>The main change that needed to be made from the previous code was changing “fill = success_lift” to “fill = success_rate”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_matrix_lift, <span class="fu">aes</span>(<span class="at">x =</span> third_pitch, <span class="at">y =</span> state, <span class="at">fill =</span> success_rate)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.45</span>, <span class="at">name =</span> <span class="st">"Success Probability (x)"</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Third Pitch (Category)"</span>, <span class="at">y =</span> <span class="st">"First + Second Pitch (Sequence)"</span>, </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effectiveness of 3-Pitch Sequences"</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We want to <strong>ensure that these effects we observe are significant</strong>. Before doing a complex test we can assess whether there are a sufficient amount of observed triplets and not just an odd few that create this effect.</p>
<p>Realize that the code below to create the count_matrix is almost the exact same as the expectancy matrix from earlier with the main difference being we are interested in counts rather than proportions. Also, the only change we made for the heat map was adding “geom_text(aes(label = count), size = 4)”. This function call allows for the values to be placed within each tile.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>count_matrix <span class="ot">&lt;-</span> three_pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(first_pitch, second_pitch, third_pitch) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">paste</span>(first_pitch, <span class="st">"+"</span>, second_pitch)) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, third_pitch, count)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(count_matrix, <span class="fu">aes</span>(<span class="at">x =</span> third_pitch, <span class="at">y =</span> state, <span class="at">fill =</span> count)) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">name =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Third Pitch (Category)"</span>, <span class="at">y =</span> <span class="st">"First + Second Pitch (Sequence)"</span>, </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Valid Observed 3-Pitch Sequences"</span>) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this initial look, we can see that it looks like we have a large number of observations with the smallest being 2159 for Off-Speed + Breaking Ball Paired with Off-Speed.</p>
<p>Now that we have looked at some visualizations and continued to expand our understanding of the data, our next step will be to create a <strong>logistic regression model</strong>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 6">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 6
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Rerun the heat map for success probability from earlier in this section but add a line of code so that you can see the proportions in each tile. (Hint: make sure to use the rounding function, round(), to improve the visual).</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Exercise 6 Answer Key">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 6 Answer Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_matrix_lift, <span class="fu">aes</span>(<span class="at">x =</span> third_pitch, <span class="at">y =</span> state, <span class="at">fill =</span> success_rate)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(success_rate, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.45</span>, <span class="at">name =</span> <span class="st">"Success Probability (x)"</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Third Pitch (Category)"</span>, <span class="at">y =</span> <span class="st">"First + Second Pitch (Sequence)"</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effectiveness of 3-Pitch Sequences"</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="logistic-regression" class="level1">
<h1>Logistic Regression</h1>
<p>Logistic regression is a way to effectively model binary outcomes. In our case, these outcomes are either <strong>success</strong> or <strong>failure</strong> from the pitcher’s perspective. The output of a logistic regression, in the form of log odds, is transformed back to a probability between 0 and 1, with ‘1’ representing a <strong>success</strong>.</p>
<p>The validity conditions for logistic regression include <u>independent</u> <u>observations</u> and <u>lack</u> <u>of</u> <u>multicollinearity</u> between explanatory variables. Independent observations is the assumption that each pitch triplet is stand-alone, that is, one triplet does not affect another. Multicollinearity is the presence of dependence between predictor variables, that is, an increase in one predictor variable is closely linked to an increase in another predictor variable. We will not dive into assessing these assumptions to determine if the model fits the validity conditions, but will instead assume them to be true.</p>
<p>The following equation is the general form for logistic regression. On the right is the linear form of the equation and on the left is the natural log of the odds. Odds are defined as the probability of an event happening divided by the probability of the event not happening.</p>
<p><span class="math display">\[ln(\frac{\pi}{1-\pi}) = \beta_0 + \beta_1 x_1 + ... + \beta_{p} x_{p}\]</span></p>
<p>We will use logistic regression to <strong>assess what sequences have the greatest effect on success probability</strong> by representing pitch pairs as individual variables in the model. We are not factoring in the third pitch type simply because it would be at risk of the imbalanced sample sizes we discovered previously. Additionally, including 3-pitch sequences would add 27 total variables to the model, making it harder to interpret. The following approach allows for only 9 (8 dummy varibales) related to pitch sequence. We will see what pitch pairs have the greatest effect on the success of the third pitch, regardless of what that pitch type is.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Discussion Questions**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Discussion Questions</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Would linear regression make sense in this context over logistic regression? What are their differences? Think about the responses of the models, how do they differ?</li>
</ul>
<p>For more information visit: <a href="https://www.statology.org/assumptions-of-logistic-regression/" class="uri">https://www.statology.org/assumptions-of-logistic-regression/</a></p>
</div>
</div>
</div>
<p>First, we essentially copied code from previous “three_pitch_seq_suc” and removed the select function at the end so that we have all variables at our disposal. We then created a new variable, “sequence_pair”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>three_pitch_seq_suc_full <span class="ot">&lt;-</span> pitch_seq <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(game_pk, at_bat_number) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">2</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_pitch =</span> <span class="fu">lag</span>(pitch_category, <span class="dv">1</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_pitch =</span> pitch_category,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">success_3 =</span> success</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(first_pitch))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>sequences <span class="ot">&lt;-</span> three_pitch_seq_suc_full <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sequence_pair =</span> <span class="fu">paste</span>(first_pitch, second_pitch, <span class="at">sep =</span> <span class="st">"+"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Note</u>: Logistic regression is susceptible to class imbalances. The following output shows the counts for successes and failures in our data. We are pretty well balanced, with 45.1% of the sequences being successes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sequences <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(success_3) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   success_3 [2]
  success_3      n
      &lt;dbl&gt;  &lt;int&gt;
1         0 199122
2         1 163629</code></pre>
</div>
</div>
<p>In our logistic regression, we include other variables, such as <code>balls</code>, <code>strikes</code>, and <code>outs_when_up</code> to account for the situation. We expect these factors to have significant confounding effects on pitch success. Logistic regression accounts for this by establishing a base class to the compare the effect individual variables have, holding all other variables constant.</p>
<p>The variables <code>balls</code>, <code>strikes</code>, and <code>outs_when_up</code> will not need any modification to be put into our model. The ball position, however, will need to be modified as it is not expected to have a monotonic effect on success probability. That is to say, the success of a pitch does not steadily increase as a pitch moves up or to the side. Currently, the data measures the pitch location in reference to the middle of the plate in the dirt. To account for this, we will change the <code>plate_x</code> and <code>plate_z</code> variables to represent the distance a ball is from the center of the strike zone. Now we can claim that the probability of success of a pitch steadily decreases as pitch moves away from the center of the strike zone.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  success_3 <span class="sc">~</span> sequence_pair <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abs</span>(plate_x) <span class="sc">+</span> <span class="fu">abs</span>(<span class="fl">2.55</span> <span class="sc">-</span> plate_z) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    balls <span class="sc">+</span> strikes <span class="sc">+</span> outs_when_up,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sequences,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = success_3 ~ sequence_pair + abs(plate_x) + abs(2.55 - 
    plate_z) + balls + strikes + outs_when_up, family = binomial, 
    data = sequences)

Coefficients:
                                      Estimate Std. Error  z value Pr(&gt;|z|)    
(Intercept)                           1.340189   0.017660   75.887  &lt; 2e-16 ***
sequence_pairBreaking Ball+Fastball  -0.026619   0.013875   -1.918 0.055056 .  
sequence_pairBreaking Ball+Off-Speed -0.059427   0.021723   -2.736 0.006226 ** 
sequence_pairFastball+Breaking Ball   0.008154   0.013666    0.597 0.550704    
sequence_pairFastball+Fastball       -0.034214   0.012165   -2.813 0.004915 ** 
sequence_pairFastball+Off-Speed      -0.046729   0.016405   -2.848 0.004393 ** 
sequence_pairOff-Speed+Breaking Ball -0.037183   0.025612   -1.452 0.146559    
sequence_pairOff-Speed+Fastball      -0.064902   0.017403   -3.729 0.000192 ***
sequence_pairOff-Speed+Off-Speed     -0.096157   0.020848   -4.612 3.98e-06 ***
abs(plate_x)                         -1.222598   0.008091 -151.108  &lt; 2e-16 ***
abs(2.55 - plate_z)                  -0.856325   0.006494 -131.872  &lt; 2e-16 ***
balls                                 0.023093   0.004100    5.632 1.78e-08 ***
strikes                              -0.065135   0.005712  -11.402  &lt; 2e-16 ***
outs_when_up                          0.024840   0.004388    5.660 1.51e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 499401  on 362750  degrees of freedom
Residual deviance: 446956  on 362737  degrees of freedom
AIC: 446984

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><u>Note</u>: The base pair in this model is Breaking Ball + Breaking Ball. This means that the coefficients provided correspond to the change in the success of that pitch pair.</p>
<p>Our logistic regression output shows the ball positioning as well as many of the sequences to be significant in predicting the success of the next pitch. The most significant sequence variable in our model was <code>Off-Speed+Off-Speed</code>.</p>
<p>The coefficient for the <code>Off-Speed+Off-Speed</code> sequence can be interpreted as follows: using a Off-Speed + Off-Speed pair rather than a Breaking Ball + Breaking Ball pair decreases the log odds of the third pitch being a success by <code>0.096</code>.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Question:**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Question:</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>How can we change this value of the log odds to be more easily interpreted?</p>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Answer:**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Answer:</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>We can assess how the odds of success changes when throwing a Off-Speed Off-Speed pair using the odds ratio determined from this coefficient.</li>
</ul>
<p>This can be done by simply transforming from log‐odds to odds via the exponential function on the coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.096157</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9083214</code></pre>
</div>
</div>
<p>This tells us that the <strong>odds of success on the third pitch decrease by roughly 10%</strong> when throwing two Off-Speeds in a row instead of two breaking balls. For this reason, we would want to avoid this pairing!</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="**Discussion Questions**">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Discussion Questions</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Pick a different pitch sequence to repeat and interpret the odds ratio. Does this reflect what we have seen throughout the module?</li>
<li>What would a positive or negative coefficient mean for the odds ratio and its interpretation?</li>
<li>How else could you expand this model to be more robust?</li>
<li>Do you think batter handedness affects the success of pitch sequencing?</li>
<li>What other variables could affect the success of a pitch?</li>
<li>Add in a variable of your choice and interpret the effect it has on third-pitch success.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this SCORE module, you learned about data cleaning and considerations you need to make when doing so. You learned about transition matrices and expectancy matrices and the information they can provide. You built heat maps to display data. Lastly, you learned how to <strong>predict the success of a pitch</strong> sequence using logistic regression. All of these tools helped you <strong>explain which pitch sequences have the highest success rates</strong> when a pitcher steps up to the mound.</p>
<p>The sequence of a pitch absolutely matters. The pitcher and the batter are trying to throw each other off to each gain an advantage. Through some extensive statistical techniques, you learned how a pitcher can throw off a batter and rack up outs, ultimately winning more innings and more games.</p>
<p>This idea of projecting an outcome based on former sequence of decisions can also be applied to other sports. You can analyze and answer questions such as: should we call a run play or a throw play on 1st and 10 in American Football, what play is the most likely to get a open three point shot in basketball based on how my opponent has been playing, and what formation should I run on the soccer pitch to maximize our chances of scoring a goal? The applications of applied statistics and data science are endless in sports. Thanks for learning with us!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Maintained by All of Us! <br> We use cookies to track usage statistics to help measure impact of the materials for authors. Please consider allowing tracking cookies.</p>
<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Manage cookies</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>