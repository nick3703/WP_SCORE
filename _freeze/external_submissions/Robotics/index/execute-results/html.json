{
  "hash": "f7680f03fcaf597ff28441e08ba1cb2f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"FIRST Robotics Competition - Winning Chances\"\nformat: html\ndate: March 5, 2024\ndescription: Evaluating the predicted winning probabilities against the actual outcomes.\neditor: \n  canonical: true\ncategories:\n  - Brier score\n  - prediction assessment\n---\n\n\n### Introduction\n\nThe [FIRST Robotics Competition](https://www.firstinspires.org/robotics/frc) (FRC) is a high school level robotics competition, in which “\\[u\\]nder strict rules and limited time and resources, teams of high school students are challenged to build industrial-size robots to play a difficult field game in alliance with other teams.” It combines “the excitement of sport with the rigors of science and technology”.\n\nOne of the key features of FRC is that robot/team competes not individually, but in alliance with other teams. So, it is important for teams to “scout” other teams as potential alliance partners. Various methodologies/models to evaluate each team’s potential contribution were developed. One of the popular models is called Expected Points Added ([EPA](https://www.statbotics.io/blog/intro)) model that produces predicted probabilities of winning for the alliance based on the past performances of each team in the alliance, as well as teams in the opposition alliance. As such, there is a desire/need to assess how good the EPA model prediction is.\n\nBrier score originated with weather forecast research. It was designed to evaluate the predicted probabilities against the actual outcomes and is straight forward to calculate. In this worksheet, we'll evaluate the predicted winning probabilities by the EPA model against the actual FRC outcomes.\n\n::: {.callout-note collapse=\"true\" title=\"Learning Objectives\" appearance=\"minimal\"}\nBy the end of this activity, you will be able to:\n\n1.  Calculate Brier score.\n\n2.  Interpret Brier score.\n:::\n\n### Data\n\nIn this lesson, we will use the EPA data and competition outcomes calculated and compiled by the website [statbotics.io](https://www.statbotics.io/).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndtAll <- read.csv(\"matches.csv\")\ndtUse <- subset(dtAll, status==\"Completed\" & offseason==\"f\", \n                select=c(year, event, playoff, comp_level, winner, epa_win_prob))\n```\n:::\n\n\nBelow is a description of the variables:\n\n<details>\n\n<summary><b>Variable Descriptions</b></summary>\n\n| Variable     | Description                                                                |\n|---------------------|---------------------------------------------------|\n| year         | the year/season of the FRC event                                           |\n| event        | unique identifier for each FRC event                                       |\n| playoff      | \"t\" for playoff match; \"f\" for qualifying match                            |\n| comp_level   | \"qm\" for qualifying match; \"sf\" for semifinals match; \"f\" for finals match |\n| winner       | winning alliance (\"red\" or \"blue\") of the match                            |\n| epa_win_prob | predicted winning probability for the Red Alliance by EPA model            |\n\n</details>\n\nThe data covers the competition seasons from 2002 to 2023, except for 2021 due to the COVID pandemic.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(dtUse$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016\n[16] 2017 2018 2019 2020 2022 2023\n```\n\n\n:::\n:::\n\n\nFor our example, we will use a particular event, the Hopper Division competition at the 2023 FRC World Championship in Houston, to illustrate the calculation of Brier score.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt2023hop <- subset(dtUse, event==\"2023hop\")\n```\n:::\n\n\nBelow is what the raw data looks like. Each row is a match between a Red alliance and a Blue alliance. Each alliance consists of three robots/teams.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-07fdb716c5c9e26a9e2f\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-07fdb716c5c9e26a9e2f\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"184438\",\"184439\",\"184440\",\"184441\",\"184442\",\"184443\",\"184444\",\"184445\",\"184446\",\"184447\",\"184448\",\"184449\",\"184450\",\"184451\",\"184452\",\"184453\",\"184454\",\"184455\",\"184456\",\"184457\",\"184458\",\"184459\",\"184460\",\"184461\",\"184462\",\"184463\",\"184464\",\"184465\",\"184466\",\"184467\",\"184468\",\"184469\",\"184470\",\"184471\",\"184472\",\"184473\",\"184474\",\"184475\",\"184476\",\"184477\",\"184478\",\"184479\",\"184480\",\"184481\",\"184482\",\"184483\",\"184484\",\"184485\",\"184486\",\"184487\",\"184488\",\"184489\",\"184490\",\"184491\",\"184492\",\"184493\",\"184494\",\"184495\",\"184496\",\"184497\",\"184498\",\"184499\",\"184500\",\"184501\",\"184502\",\"184503\",\"184504\",\"184505\",\"184506\",\"184507\",\"184508\",\"184509\",\"184510\",\"184511\",\"184512\",\"184513\",\"184514\",\"184515\",\"184516\",\"184517\",\"184518\",\"184519\",\"184520\",\"184521\",\"184522\",\"184523\",\"184524\",\"184525\",\"184526\",\"184527\",\"184528\",\"184529\",\"184530\",\"184531\",\"184532\",\"184533\",\"184534\",\"184535\",\"184536\",\"184537\",\"184538\",\"184539\",\"184540\",\"184541\",\"184542\",\"184543\",\"184544\",\"184545\",\"184546\",\"184547\",\"184548\",\"184549\",\"184550\",\"184551\",\"184552\",\"184553\",\"184554\",\"184555\",\"184556\",\"184557\",\"184558\",\"184559\",\"184560\",\"184561\",\"184562\",\"184563\",\"184564\",\"184565\",\"184566\",\"184567\",\"184568\",\"184569\",\"184570\",\"184571\",\"184572\",\"184573\",\"184574\",\"184575\",\"184576\",\"184577\",\"184578\",\"184579\",\"184580\",\"184581\"],[2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\",\"2023hop\"],[\"t\",\"t\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\",\"t\"],[\"f\",\"f\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\"],[\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\"],[0.8098,0.8139,0.2119,0.0164,0.0513,0.9556,0.6732,0.1905,0.5590000000000001,0.2945,0.6875,0.2375,0.8416,0.3573,0.1988,0.1922,0.4558,0.0389,0.7692,0.5935,0.0664,0.3113,0.09030000000000001,0.2739,0.9115,0.0238,0.9344,0.0747,0.1817,0.8063,0.9847,0.5256,0.0774,0.2068,0.5395,0.556,0.5485,0.07340000000000001,0.8300999999999999,0.946,0.0769,0.1266,0.2962,0.8608,0.0304,0.1165,0.0501,0.1524,0.9244,0.1189,0.4938,0.3234,0.7444,0.3099,0.2941,0.5966,0.7569,0.1567,0.0466,0.8371,0.3568,0.7433999999999999,0.5425,0.9699,0.4388,0.0266,0.3577,0.7587,0.2518,0.8619,0.9127,0.8016,0.2237,0.0271,0.0567,0.7177,0.9757,0.6573,0.5514,0.8925,0.4517,0.5183,0.2812,0.0102,0.8304,0.6898,0.0399,0.9698,0.9869,0.9665,0.286,0.8043,0.6422,0.8848,0.1984,0.3101,0.9500999999999999,0.0594,0.8188,0.1664,0.9708,0.0326,0.623,0.1834,0.4705,0.3365,0.2963,0.7822,0.7175,0.8112,0.2459,0.1892,0.377,0.9762,0.967,0.9944,0.23,0.4743,0.6536999999999999,0.9435,0.9937,0.2653,0.09420000000000001,0.2304,0.4764,0.6741,0.8946,0.6577,0.3189,0.9188,0.7792,0.4027,0.8357,0.3662,0.3826,0.6757,0.5645,0.6806,0.3726,0.6911,0.8492,0.7203000000000001,0.4296,0.4952]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>year<\\/th>\\n      <th>event<\\/th>\\n      <th>playoff<\\/th>\\n      <th>comp_level<\\/th>\\n      <th>winner<\\/th>\\n      <th>epa_win_prob<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"year\",\"targets\":1},{\"name\":\"event\",\"targets\":2},{\"name\":\"playoff\",\"targets\":3},{\"name\":\"comp_level\",\"targets\":4},{\"name\":\"winner\",\"targets\":5},{\"name\":\"epa_win_prob\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Brier Score\n\nFor match $i$, let $f_i$ denote the probability forecast. In our case, it is the predicted winning probability for the Red Alliance by EPA model, i.e., the variable *epa_win_prob*. Let $o_i$ denote the match outcome: $o_i=1$ when the Red alliance won and $o_i=0$ when the Blue alliance won. The Brier score for match $i$ is calculated as $(f_i - o_i)^2$. For example, suppose it is predicted that the Red alliance will win with 80% probability, i.e.,  $f_i=0.8$, if the actual outcome is that the Red alliance won, the Brier score is $(0.8-1)^2=0.04$. If the actual outcome is that the Blue alliance won, the Brier score is $(0.8-0)^2=0.64$.\n\nBrier score is a quantity bounded by $0$ and $1$. Brier score of $0$ means correctly predicting the outcome with 100% certainty. 50:50 random guess would give a Brier score of $0.25$. The overall Brier score for all the matches during a competition event or season is simply the average of individual match scores:\n$$\\frac{1}{N} \\sum_{i=1}^N (f_i - o_i)^2$$\nThe following table shows the calculation for each match.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-c35eed773df150565341\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c35eed773df150565341\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"184438\",\"184439\",\"184440\",\"184441\",\"184442\",\"184443\",\"184444\",\"184445\",\"184446\",\"184447\",\"184448\",\"184449\",\"184450\",\"184451\",\"184452\",\"184453\",\"184454\",\"184455\",\"184456\",\"184457\",\"184458\",\"184459\",\"184460\",\"184461\",\"184462\",\"184463\",\"184464\",\"184465\",\"184466\",\"184467\",\"184468\",\"184469\",\"184470\",\"184471\",\"184472\",\"184473\",\"184474\",\"184475\",\"184476\",\"184477\",\"184478\",\"184479\",\"184480\",\"184481\",\"184482\",\"184483\",\"184484\",\"184485\",\"184486\",\"184487\",\"184488\",\"184489\",\"184490\",\"184491\",\"184492\",\"184493\",\"184494\",\"184495\",\"184496\",\"184497\",\"184498\",\"184499\",\"184500\",\"184501\",\"184502\",\"184503\",\"184504\",\"184505\",\"184506\",\"184507\",\"184508\",\"184509\",\"184510\",\"184511\",\"184512\",\"184513\",\"184514\",\"184515\",\"184516\",\"184517\",\"184518\",\"184519\",\"184520\",\"184521\",\"184522\",\"184523\",\"184524\",\"184525\",\"184526\",\"184527\",\"184528\",\"184529\",\"184530\",\"184531\",\"184532\",\"184533\",\"184534\",\"184535\",\"184536\",\"184537\",\"184538\",\"184539\",\"184540\",\"184541\",\"184542\",\"184543\",\"184544\",\"184545\",\"184546\",\"184547\",\"184548\",\"184549\",\"184550\",\"184551\",\"184552\",\"184553\",\"184554\",\"184555\",\"184556\",\"184557\",\"184558\",\"184559\",\"184560\",\"184561\",\"184562\",\"184563\",\"184564\",\"184565\",\"184566\",\"184567\",\"184568\",\"184569\",\"184570\",\"184571\",\"184572\",\"184573\",\"184574\",\"184575\",\"184576\",\"184577\",\"184578\",\"184579\",\"184580\",\"184581\"],[\"f\",\"f\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"qm\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\",\"sf\"],[\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"red\",\"red\",\"blue\",\"blue\",\"red\",\"red\",\"red\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"blue\",\"red\",\"red\",\"red\"],[0.8098,0.8139,0.2119,0.0164,0.0513,0.9556,0.6732,0.1905,0.5590000000000001,0.2945,0.6875,0.2375,0.8416,0.3573,0.1988,0.1922,0.4558,0.0389,0.7692,0.5935,0.0664,0.3113,0.09030000000000001,0.2739,0.9115,0.0238,0.9344,0.0747,0.1817,0.8063,0.9847,0.5256,0.0774,0.2068,0.5395,0.556,0.5485,0.07340000000000001,0.8300999999999999,0.946,0.0769,0.1266,0.2962,0.8608,0.0304,0.1165,0.0501,0.1524,0.9244,0.1189,0.4938,0.3234,0.7444,0.3099,0.2941,0.5966,0.7569,0.1567,0.0466,0.8371,0.3568,0.7433999999999999,0.5425,0.9699,0.4388,0.0266,0.3577,0.7587,0.2518,0.8619,0.9127,0.8016,0.2237,0.0271,0.0567,0.7177,0.9757,0.6573,0.5514,0.8925,0.4517,0.5183,0.2812,0.0102,0.8304,0.6898,0.0399,0.9698,0.9869,0.9665,0.286,0.8043,0.6422,0.8848,0.1984,0.3101,0.9500999999999999,0.0594,0.8188,0.1664,0.9708,0.0326,0.623,0.1834,0.4705,0.3365,0.2963,0.7822,0.7175,0.8112,0.2459,0.1892,0.377,0.9762,0.967,0.9944,0.23,0.4743,0.6536999999999999,0.9435,0.9937,0.2653,0.09420000000000001,0.2304,0.4764,0.6741,0.8946,0.6577,0.3189,0.9188,0.7792,0.4027,0.8357,0.3662,0.3826,0.6757,0.5645,0.6806,0.3726,0.6911,0.8492,0.7203000000000001,0.4296,0.4952],[1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,1,0,1,0,1,1,0,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,1,0,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,1,1,0,1,0,1,0,1,0,1,1,1,0,0,1,1,1,0,0,1,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1],[0.03617604000000001,0.03463321000000002,0.04490161,0.0002689600000000001,0.00263169,0.00197136,0.10679824,0.03629025,0.3124810000000001,0.08673024999999999,0.09765625,0.05640625,0.02509055999999999,0.4130632900000001,0.6419214400000001,0.6525408399999999,0.29615364,0.00151321,0.05326864,0.35224225,0.00440896,0.09690769000000002,0.008154090000000001,0.52722121,0.007832250000000004,0.0005664400000000001,0.004303359999999999,0.00558009,0.03301489,0.03751968999999999,0.0002340899999999994,0.22505536,0.005990759999999999,0.04276624,0.21206025,0.3091360000000001,0.20385225,0.005387560000000001,0.02886601000000002,0.002916000000000005,0.00591361,0.01602756,0.08773444000000001,0.01937664,0.00092416,0.01357225,0.00251001,0.02322576,0.00571536,0.01413721,0.25623844,0.10458756,0.06533136000000002,0.09603801000000001,0.08649480999999998,0.35593156,0.05909760999999999,0.02455489,0.00217156,0.02653641000000001,0.41370624,0.5526435599999999,0.20930625,0.0009060100000000009,0.3149454399999999,0.00070756,0.12794929,0.5756256900000001,0.5598032399999999,0.01907161,0.007621290000000008,0.03936256000000001,0.05004169000000001,0.0007344099999999999,0.00321489,0.07969329,0.0005904899999999994,0.43204329,0.20124196,0.01155625000000001,0.30063289,0.23203489,0.07907344000000001,0.00010404,0.02876415999999999,0.09622404000000002,0.00159201,0.0009120400000000002,0.00017161,0.001122249999999998,0.5097959999999999,0.03829849,0.41242084,0.01327103999999999,0.64256256,0.09616200999999999,0.002490010000000006,0.00352836,0.03283344000000001,0.02768896,0.0008526400000000002,0.00106276,0.142129,0.66683556,0.2803702500000001,0.11323225,0.08779369000000001,0.04743683999999999,0.07980624999999998,0.03564543999999999,0.06046681,0.03579664,0.388129,0.000566440000000002,0.001089000000000002,3.136000000000055e-05,0.0529,0.22496049,0.4273236899999999,0.003192249999999999,3.968999999999965e-05,0.07038409,0.00887364,0.05308416,0.22695696,0.10621081,0.01110916000000001,0.4325692899999999,0.10169721,0.006593440000000008,0.04875264,0.3567672899999999,0.02699449,0.4017024399999999,0.14638276,0.10517049,0.18966025,0.46321636,0.39363076,0.09541920999999998,0.7211406399999999,0.07823208999999998,0.32535616,0.25482304]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>comp_level<\\/th>\\n      <th>winner<\\/th>\\n      <th>epa_win_prob<\\/th>\\n      <th>outcome<\\/th>\\n      <th>score<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"comp_level\",\"targets\":1},{\"name\":\"winner\",\"targets\":2},{\"name\":\"epa_win_prob\",\"targets\":3},{\"name\":\"outcome\",\"targets\":4},{\"name\":\"score\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe overall Brier score for the 2023 Hopper Division event is 0.1366352, which is slightly worse than the half way between perfect $0$ and random guess $0.25$.\n\n### Your Turn\n\nNow, it's your turn. Please use the data from the Turing Division competition at the 2022 FRC World Championship to calculate the average Brier score for the event. You should find the data in the file **dt2022tur.csv**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt2022tur <- subset(dtUse, event==\"2022tur\")\nwrite.csv(dt2022tur, \"dt2022tur.csv\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Answer\" appearance=\"minimal\"}\nThe average Brier score for the 2022 Turing Division event is 0.1160236, which is better than the Brier score for the 2023 Hopper Division event.\n:::\n\n### Over the Years\n\nSince we have the data for more than 20 years, we could answer an interesting question: did the predictive ability of the EPA model change over the years?\n\nWe build two simple functions to do the calculations.\n\n<details>\n\n<summary><b>Two Functions</b></summary>\n\nThe first function calculates the Brier score for a given data set. Occasionally, a game can end in a draw. We assign the value of $0.5$ to $o_i$ for a draw.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalcBS <- function(dt){\n  n <- nrow(dt)\n  outcome <- rep(NA, n)\n  outcome[dt$winner==\"red\"] <- 1\n  outcome[dt$winner==\"draw\"] <- 0.5\n  outcome[dt$winner==\"blue\"] <- 0\n  diff <- dt$epa_win_prob - outcome\n  Brier <- mean(diff^2)\n  c(n=n, Brier=Brier)\n}\n```\n:::\n\n\nThe second function separates the data by year and does the calculation for each year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyYear <- function(dt=dtUse) {\n  yrs <- unique(dt$year)\n  m <- length(yrs)\n  size <- Brier <- rep(NA, m)\n  for (i in 1:m) {\n    dat <- subset(dt, year==yrs[i])\n    res <- calcBS(dt=dat)\n    size[i] <- res[1]\n    Brier[i] <- res[2]\n  }\n  data.frame(year=yrs, n=size, Brier=Brier)\n}\nFRC <- byYear()\n```\n:::\n\n\n</details>\n\nBelow are the Brier scores from 2002 to 2023.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(FRC)\n```\n\n::: {.cell-output-display}\n\n\n| year|     n|     Brier|\n|----:|-----:|---------:|\n| 2002|  2197| 0.2351889|\n| 2003|  3173| 0.2225493|\n| 2004|  3198| 0.2069319|\n| 2005|  2059| 0.2043631|\n| 2006|  3283| 0.1997467|\n| 2007|  3563| 0.2099309|\n| 2008|  4036| 0.1892942|\n| 2009|  4567| 0.1961946|\n| 2010|  5564| 0.1691369|\n| 2011|  6224| 0.1621286|\n| 2012|  7707| 0.1841302|\n| 2013|  8242| 0.1704309|\n| 2014| 10663| 0.1906669|\n| 2015| 11810| 0.1841460|\n| 2016| 13286| 0.1794790|\n| 2017| 15429| 0.2043697|\n| 2018| 16930| 0.1750251|\n| 2019| 18022| 0.1758972|\n| 2020|  4634| 0.1817734|\n| 2022| 14645| 0.1480655|\n| 2023| 16319| 0.1604984|\n\n\n:::\n:::\n\n\nIt is interesting to note that the predictive ability of the EPA model has improved for the past 20 years. Since the model has not changed, I believe the improvement comes from established teams becoming more consistent and predictable. Meanwhile, the pool of newer, less experienced teams has stayed healthy. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(FRC$year, FRC$Brier)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\" title=\"Conclusion\" appearance=\"minimal\"}\nIn conclusion, Brier score is a simple statistic that assesses the probability prediction against actual outcome. A smaller Brier score corresponds to better prediction.\n\nThe EPA model has been getting better at predicting FRC match outcome.\n:::\n\n### Author\n\nCreated by [Jake Tan (Wissahickon High School)](https://www.jakeatan.com/). Jake is a subsystem leader at [FRC Team 341, Miss Daisy](https://www.team341.com/). Team 341 competed at FRC World Championship in the Turing Division in 2022 and Hopper Division in 2023.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}